//>>built
require({cache:{"gridx/core/model/_Extension":function(){define(["dojo/_base/declare","dojo/_base/connect","dojo/_base/array"],function(m,j,k){return m([],{constructor:function(i){var d=this.inner=i._model;this._cnnts=[];this.model=i;i._model=this;d&&(this.connect(d,"onDelete","_onDelete"),this.connect(d,"onNew","_onNew"),this.connect(d,"onSet","_onSet"),this.connect(d,"onSizeChange","_onSizeChange"))},destroy:function(){k.forEach(this._cnnts,j.disconnect)},connect:function(i,d,c,f){i=j.connect(i,
d,f||this,c);this._cnnts.push(i);return i},_onNew:function(){this.onNew.apply(this,arguments)},_onSet:function(){this.onSet.apply(this,arguments)},_onDelete:function(){this.onDelete.apply(this,arguments)},_onSizeChange:function(){this.onSizeChange.apply(this,arguments)},onNew:function(){},onDelete:function(){},onSet:function(){},onSizeChange:function(){},_call:function(i,d){var c=this[i],f=this.inner;return c?c.apply(this,d||[]):f&&f._call(i,d)},_mixinAPI:function(){var i,d=this.model,c=arguments,
f=function(f){return function(){return d._model._call(f,arguments)}};for(i=c.length-1;i>=0;--i)d[c[i]]=f(c[i])}})})},"gridx/core/model/extensions/Sort":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","../_Extension"],function(m,j,k,i){return m(i,{name:"sort",priority:20,constructor:function(d,c){var f=c.baseSort;this.clear();this._mixinAPI("sort");if(f&&f.length)this._baseSort=f,this._sort()},clear:function(){},sort:function(){this.model._addCmd({name:"_cmdSort",scope:this,
args:arguments})},_cmdSort:function(){var d=arguments;this._sort.apply(this,d[d.length-1])},_sort:function(d){var c=this.model,f=this._baseSort,h=c._cache,a=h.options=h.options||{},b,e,g;if(j.isArrayLike(d)){for(b=0;b<d.length;++b)e=d[b],e.colId!==void 0?e.attribute=h.columns?h.columns[e.colId].field||e.colId:e.colId:e.colId=e.attribute;f&&(d=d.concat(f))}else d=f;a.sort&&a.sort.length?k.toJson(a.sort)!==k.toJson(d)&&(g=1):d&&d.length&&(g=1);a.sort=j.clone(d);g&&h.clear();c._msg("storeChange")}})})},
"gridx/modules/VScroller":function(){define(["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/event","dojo/_base/sniff","dojo/_base/query","dojo/keys","dojox/html/metrics","../core/_Module"],function(m,j,k,i,d,c,f,h){return h.register(m(h,{name:"vScroller",forced:["body","vLayout","columnWidth"],optional:["pagination"],getAPIPath:function(){return{vScroller:this}},preload:function(){var a=this.grid,b=this.domNode=a.vScrollerNode;this.stubNode=b.firstChild;if(i("ie")<8)this.stubNode.style.width=
f.getScrollbar().w+"px";a.autoHeight?b.style.display="none":this.domNode.style.width=f.getScrollbar().w+"px";a.hLayout.register(null,b,1)},load:function(a,b){var e=this,g=e.grid,l=g.bodyNode;e.batchConnect([e.domNode,"onscroll","_doScroll"],[l,"onmousewheel","_onMouseWheel"],[g.mainNode,"onkeypress","_onKeyScroll"],[g.body,"onRender","_onBodyChange"],[g.body,"onForcedScroll","_onForcedScroll"],[g,"_onResizeEnd","_onBodyChange"],i("ff")&&[l,"DOMMouseScroll","_onMouseWheel"]);b.then(function(){j.when(e._init(a),
function(){e.domNode.style.width="";e.loaded.callback()})})},scrollToPercentage:function(a){this.domNode.scrollTop=this.stubNode.style.clientHeight*a/100},scrollToRow:function(a,b){var e=new j,g=this.grid.bodyNode,l=this.domNode,p=0,f=d('[visualindex="'+a+'"]',g)[0];if(f){var p=f.offsetTop,c=g.scrollTop;if(b)return l.scrollTop=p,e.callback(!0),e;else if(p<c)p-=c;else if(p+f.offsetHeight>c+g.clientHeight)p=p+f.offsetHeight-c-g.clientHeight;else return e.callback(!0),e;l.scrollTop+=p}e.callback(!!f);
return e},_init:function(){this._onForcedScroll()},_doScroll:function(){this.grid.bodyNode.scrollTop=this.domNode.scrollTop},_onMouseWheel:function(a){this.grid.autoHeight||(this.domNode.scrollTop-=typeof a.wheelDelta==="number"?a.wheelDelta/3:-40*a.detail,k.stop(a))},_onBodyChange:function(){var a=this,b=a.grid;window.setTimeout(function(){a.stubNode.style.height=b.bodyNode.scrollHeight+"px";a._doScroll();b.vScrollerNode.scrollTop=b.vScrollerNode.scrollTop||0},0)},_onForcedScroll:function(){var a=
this,b=a.grid.body;return a.model.when({start:b.rootStart,count:b.rootCount},function(){b.renderRows(0,b.rootCount||a.model.size()-start)})},_onKeyScroll:function(a){var l;var g;var b=this.grid.body,e=this.domNode;if(a.keyCode==c.HOME)b._focusCellRow=0,e.scrollTop=0;else if(a.keyCode==c.END)b._focusCellRow=b.visualCount-1,e.scrollTop=this.stubNode.clientHeight-b.domNode.offsetHeight;else if(a.keyCode==c.PAGE_UP)g=b._focusCellRow=Math.max(b.renderStart-b.renderCount,0),b=g,this.scrollToRow(b,1);else if(a.keyCode==
c.PAGE_DOWN)l=b._focusCellRow=Math.min(b.visualCount-1,b.renderStart+b.renderCount),b=l,this.scrollToRow(b,1);else return;k.stop(a)}}))})},"gridx/core/model/Model":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/Deferred","dojo/DeferredList","dojo/_base/connect"],function(m,j,k,i,d,c){var f=k.isArrayLike,h=k.isString;return m(null,{constructor:function(a){this.store=a.store;this._exts={};this._cmdQueue=[];this._model=this._cache=new a.cacheClass(this,a);this._createExts(a.modelExtensions||
[],a);a=this._model;this._connects=[c.connect(a,"onDelete",this,"onDelete"),c.connect(a,"onNew",this,"onNew"),c.connect(a,"onSet",this,"onSet"),c.connect(a,"onSizeChange",this,"onSizeChange")]},destroy:function(){j.forEach(this._connects,c.disconnect);for(var a in this._exts)this._exts[a].destroy()},clearCache:function(){this._cache.clear()},when:function(){this._addCmd({name:"_cmdRequest",scope:this,args:arguments,async:1});return this._exec()},scan:function(a,b){var e=new i,g=a.start||0,l=a.pageSize||
this._cache.pageSize||1,p=a.count>0?g+a.count:Infinity,f=a.whenScope||this,c=a.whenFunc||f.when,d=function(g){c.call(f,{id:[],range:[{start:g,count:l}]},function(){var a,e,c=[];for(a=g;a<g+l&&a<p;++a)if(e=f.byIndex(a))c.push(e);else{p=-1;break}if(b(c,g)||a==p)p=-1}).then(function(){p==-1?e.callback():d(g+l)})};d(g);return e},onDelete:function(){},onNew:function(){},onSet:function(){},onSizeChange:function(){},_msg:function(){},_addCmd:function(a){var b=this._cmdQueue,e=b[b.length-1];e&&e.name===a.name&&
e.scope===a.scope?e.args.push(a.args||[]):(a.args=[a.args||[]],b.push(a))},_cmdRequest:function(){return new d(j.map(arguments,function(a){var b=a[0],e=k.hitch(a[2]||window,a[1]||function(){});if(b===null||!a.length)return e(),a=new i,a.callback(),a;return this._model._call("when",[this._normArgs(b),e])},this),0,1)},_exec:function(){var a=this,b=a._cache,e=new i,g=a._cmdQueue,l=function(g,l){a._busy=0;b.skipCacheSizeCheck=0;b._checkSize&&b._checkSize();l?g.errback(l):g.callback()},p=function(){if(j.some(g,
function(a){return a.name==="_cmdRequest"}))try{for(;g.length;){var a=g.shift(),b=a.scope[a.name].apply(a.scope,a.args);if(a.async){i.when(b,p,k.partial(l,e));return}}}catch(f){l(e,f);return}l(e)};if(a._busy)return a._busy;a._busy=e;b.skipCacheSizeCheck=1;p();return e},_createExts:function(a,b){a=j.filter(a,function(a){return a&&a.prototype});a.sort(function(a,g){return a.prototype.priority-g.prototype.priority});for(var e=0,g=a.length;e<g;++e)if(e==a.length-1||a[e]!=a[e+1]){var l=new a[e](this,b);
this._exts[l.name]=l}},_normArgs:function(a){var b,e=[],g=[],l={range:e,id:g},p=function(a){return typeof a=="number"&&a>=0},c=function(a){if(a&&p(a.start))e.push(a);else if(p(a))e.push({start:a,count:1});else if(f(a))for(b=a.length-1;b>=0;--b)p(a[b])?e.push({start:a[b],count:1}):a[b]&&p(a[b].start)?e.push(a[b]):h(a)&&g.push(a[b]);else h(a)&&g.push(a)};if(a&&(a.index||a.range||a.id))if(c(a.index),c(a.range),f(a.id))for(b=a.id.length-1;b>=0;--b)g.push(a.id[b]);else a.id&&g.push(a.id);else c(a);!e.length&&
!g.length&&this.size()<0&&e.push({start:0,count:this._cache.pageSize||1});return l}})})},"gridx/core/_Module":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect"],function(m,j,k,i){var d=j.isFunction,m=m([],{constructor:function(f,c){this.grid=f;this.model=f.model;this._cnnts=[];this._sbscs=[];j.mixin(this,c)},destroy:function(){var f=k.forEach;f(this._cnnts,i.disconnect);f(this._sbscs,i.unsubscribe)},arg:function(f,c,a){arguments.length==2&&d(c)&&(a=
c,c=void 0);var b=this.grid,e=this[f];if(!this.hasOwnProperty(f)){var g=this.name+f.substring(0,1).toUpperCase()+f.substring(1);b[g]===void 0?c!==void 0&&(e=c):e=b[g]}this[f]=a&&!a(e)?c:e;return e},connect:function(c,h,a,b,e){var g=this.grid,l=b||this,c=c===g&&typeof h=="string"?i.connect(c,h,function(){var b=arguments;g._eventFlags[h]===e&&(d(a)?a.apply(l,b):d(l[a])&&l[a].apply(l,b))}):i.connect(c,h,l,a);this._cnnts.push(c);return c},batchConnect:function(){for(var c=0,d=arguments,a=d.length;c<a;++c)j.isArrayLike(d[c])&&
this.connect.apply(this,d[c])},subscribe:function(c,d,a){c=i.subscribe(c,a||this,d);this._sbscs.push(c);return c}}),c=m._modules={};m.register=function(d){var h=d.prototype;return c[h.name||h.declaredClass]=d};m._markupAttrs=["id","name","field","width","dataType","!formatter","!decorator","!sortable"];return m})},"gridx/modules/ColumnResizer":function(){define(["dojo/_base/declare","dojo/_base/sniff","dojo/_base/window","dojo/dom","dojo/dom-style","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry",
"dojo/query","../core/_Module"],function(m,j,k,i,d,c,f,h,a,b){function e(a){var g=a.target;if(g){if(/table/i.test(g.tagName)){for(var a=a.offsetX||a.layerX||0,b=0,g=g.rows[0].cells;a>0;)a-=g[b].offsetWidth,b++;return g[b]||null}for(;g&&g.tagName;){if(g.tagName.toLowerCase()=="th")return g;g=g.parentNode}}return null}var g=c.remove;return b.register(m(b,{name:"columnResizer",minWidth:20,detectWidth:5,load:function(){var a=this.grid;this.batchConnect([a.header.innerNode,"mousemove","_mousemove"],[a,
"onHeaderMouseOut","_mouseout"],[a,"onHeaderMouseDown","_mousedown",this,this.name],[k.doc,"mousemove","_docMousemove"],[k.doc,"onmouseup","_mouseup"]);this.loaded.callback()},getAPIPath:function(){return{columnResizer:this}},columnMixin:{setWidth:function(a){this.grid.columnResizer.setWidth(this.id,a)}},setWidth:function(g,b){var e=this.grid,c=this.arg("minWidth"),f,b=parseInt(b,10);b<c&&(b=c);e._columnsById[g].width=b+"px";a('[colid="'+g+'"]',e.domNode).forEach(function(a){f||(f=j("webkit")?a.offsetWidth:
d.get(a,"width"));a.style.width=b+"px"});e.vLayout.reLayout();e.header.onRender();e.body.onRender();this.onResize(g,b,f)},onResize:function(){},_mousemove:function(a){var b=e(a),d=this.grid._eventFlags;if(b&&(this._resizing&&g(b,"gridxHeaderCellOver"),!this._resizing&&b&&!this._ismousedown))a=this._readyToResize=this._isInResizeRange(a),d.onHeaderMouseDown=d.onHeaderCellMouseDown=a?this.name:void 0,c.toggle(k.body(),"gridxColumnResizing",a),a&&g(b,"gridxHeaderCellOver")},_docMousemove:function(a){this._resizing&&
this._updateResizerPosition(a)},_mouseout:function(){if(!this._resizing)this._readyToResize=0,g(k.body(),"gridxColumnResizing")},_updateResizerPosition:function(a){var g=a.pageX-this._startX,b=this._targetCell,e=this.grid,c=e.hScroller,f=0,a=a.pageX-this._gridX,f=this.arg("minWidth");b.offsetWidth+g<f&&(a=this._startX-this._gridX-b.offsetWidth+f);g=c&&c.container.offsetHeight?c.container:e.bodyNode;f=g.parentNode.offsetTop+g.offsetHeight-e.header.domNode.offsetTop;d.set(this._resizer,{top:e.header.domNode.offsetTop+
"px",left:a+"px",height:f+"px"})},_showResizer:function(a){if(!this._resizer)this._resizer=f.create("div",{className:"gridxColumnResizer"},this.grid.domNode,"last"),this.connect(this._resizer,"mouseup","_mouseup");this._resizer.style.display="block";this._updateResizerPosition(a)},_hideResizer:function(){this._resizer.style.display="none"},_mousedown:function(a){var g=this.grid.bodyNode;this._readyToResize?(i.setSelectable(this.grid.domNode,!1),k.doc.onselectstart=function(){return!1},this._resizing=
1,this._startX=a.pageX,this._gridX=h.position(g).x-g.offsetLeft,this._showResizer(a)):this._ismousedown=1},_mouseup:function(a){this._ismousedown=0;if(this._resizing){this._readyToResize=this._resizing=0;g(k.body(),"gridxColumnResizing");i.setSelectable(this.grid.domNode,!0);k.doc.onselectstart=null;var b=this._targetCell,a=a.pageX-this._startX,a=(j("webkit")?b.offsetWidth:d.get(b,"width"))+a,e=this.arg("minWidth");a<e&&(a=e);this.setWidth(b.getAttribute("colid"),a);this._hideResizer()}},_isInResizeRange:function(a){var g=
e(a),b;var c=a.target,d=e(a);if(d)if(/table/i.test(c.tagName))b=0;else{b=a.offsetX;if(b==void 0)b=a.layerX;/th/i.test(c.tagName)||(b+=c.offsetLeft);j("ff")&&/th/i.test(c.tagName)&&(a=b-parseInt(d.parentNode.parentNode.parentNode.style.marginLeft,10)-d.offsetLeft,a>=0&&(b=a))}else b=1E5;a=this.arg("detectWidth");if(b<a)return!!(this._targetCell=g.previousSibling);else if(b>g.offsetWidth-a&&b<=g.offsetWidth)return this._targetCell=g,1;return 0}}))})},"gridx/modules/VLayout":function(){define(["dojo/_base/declare",
"dojo/dom-geometry","dojo/DeferredList","../core/_Module"],function(m,j,k,i){return i.register(m(i,{name:"vLayout",getAPIPath:function(){return{vLayout:this}},preload:function(){var d=this,c=d.grid;d.connect(c,"_onResizeEnd",function(c,h){var a,b=[];for(a in h)b.push(h[a]);(new k(b)).then(function(){d.reLayout()})});c.autoHeight?d.connect(c.body,"onRender","reLayout"):d.connect(c,"setColumns",function(){setTimeout(function(){d.reLayout()},0)})},load:function(d,c){var f=this;c.then(function(){f._defs&&
f._mods?(new k(f._defs)).then(function(){f._layout();f.loaded.callback()}):f.loaded.callback()})},register:function(d,c,f,h,a){this._defs=this._defs||[];this._mods=this._mods||{};this._mods[f]=this._mods[f]||[];this._defs.push(a||d.loaded);this._mods[f].push({p:h||0,mod:d,nodeName:c})},reLayout:function(){var d,c=0,f;for(d in this._mods)(f=this.grid[d])&&(c+=j.getMarginBox(f).h);this._updateHeight(c)},_layout:function(){var d,c=0,f=this._mods,h,a,b,e,g;for(d in f)if(h=this.grid[d]){b=f[d];b.sort(function(a,
g){return a.p-g.p});for(a=0;a<b.length;++a)e=b[a].mod,g=b[a].nodeName,e&&e[g]&&h.appendChild(e[g]);c+=j.getMarginBox(h).h}this._updateHeight(c)},_updateHeight:function(d){var c=this.grid,f=c.domNode,h=c.mainNode.style;c.autoHeight?c.vScroller.loaded.then(function(){var a=c.bodyNode.lastChild,a=a?a.offsetTop+a.offsetHeight:0;f.style.height=a+d+"px";h.height=a+"px"}):h.height=f.clientHeight-d+"px"}}))})},"gridx/util":function(){define([],function(){return{stopEvent:function(m){m&&m.stopPropagation&&
m.preventDefault&&(m.stopPropagation(),m.preventDefault())},biSearch:function(m,j){var k=0,i=m.length,d;for(d=Math.floor((k+i)/2);k+1<i;d=Math.floor((k+i)/2))j(m[d])>0?i=d:k=d;return m.length&&j(m[k])>=0?k:i}}})},"gridx/core/model/cache/_Cache":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/Deferred","../_Extension"],function(m,j,k,i,d){var c=k.hitch,f=k.mixin,h=j.indexOf;return m(d,{constructor:function(a,b){var b=b||{},e=this,g=e.store=b.store,l=g.fetch;
e.columns=b.columns;!l&&g.notify?e.connect(g,"notify",function(a,g){a===void 0?e._onDelete(g):g===void 0?e._onNew(a):e._onSet(a)}):(e.connect(g,l?"onSet":"put","_onSet"),e.connect(g,l?"onNew":"add","_onNew"),e.connect(g,l?"onDelete":"remove","_onDelete"));e.clear();e._mixinAPI("byIndex","byId","indexToId","idToIndex","size","treePath","hasChildren","keep","free","item")},destroy:function(){this.inherited(arguments);this.clear()},clear:function(){this._priority=[];this._struct={};this._cache={};this._size=
{};this._struct[""]=[];this._size[""]=-1},byIndex:function(a,b){this.prepare("byIndex",arguments);return this._cache[this.indexToId(a,b)]},byId:function(a){this.prepare("byId",arguments);return this._cache[a]},indexToId:function(a,b){this.prepare("indexToId",arguments);var e=this._struct[b||""];return e&&e[a+1]},idToIndex:function(a){this.prepare("idToIndex",arguments);var b=this._struct,b=h(b[b[a]&&b[a][0]]||[],a);return b>0?b-1:-1},treePath:function(a){for(var b=this._struct,e=[];a!==void 0;)e.unshift(a),
a=b[a]&&b[a][0];return e[0]!==""?[]:(e.pop(),e)},hasChildren:function(a){var b=this.store;this.prepare("hasChildren",arguments);var e=this.byId(a);return b.hasChildren&&b.hasChildren(a,e&&e.item)},size:function(a){this.prepare("size",arguments);var b=this._size[a||""];return b>=0?b:-1},onBeforeFetch:function(){},onAfterFetch:function(){},onSetColumns:function(a){var b,e,g,l;this.columns=a;for(b in this._cache)for(g in e=this._cache[b],a)l=a[g],e.data[g]=this._formatCell(l.id,e.rawData)},_itemToObject:function(a){var b=
this.store;if(b.fetch){var e,g,l={},c=b.getAttributes(a);e=0;for(g=c.length;e<g;++e)l[c[e]]=b.getValue(a,c[e]);return l}return a},_formatCell:function(a,b){var c=this.columns[a];return c.formatter?c.formatter(b):b[c.field||a]},_formatRow:function(a){var b=this.columns,c={},g;if(!b)return a;for(g in b)c[g]=this._formatCell(g,a);return c},_addRow:function(a,b,c,g,l){var l=l||"",d=this._struct,f=this._priority,o=d[l];if(!o)throw Error("Fatal error of cache._addRow: parent item "+l+" of "+a+" is not loaded");
if(o[b+1]){if(o[b+1]!==a)throw Error("Fatal error of cache._addRow: different row id "+a+" and "+o[b+1]+" for same row index "+b);}else o[b+1]=a;d[a]=d[a]||[l];l||(b=h(f,a),b>=0&&f.splice(b,1),f.push(a));this._cache[a]={data:this._formatRow(c),rawData:c,item:g}},_loadChildren:function(a){var b=new i,e=this,g=e.store,l=[],d=e.byId(a);d&&(l=g.getChildren&&g.getChildren(d.item)||[]);i.when(l,function(l){e._size[a]=l.length;for(var c=0,d=l.length;c<d;++c){var f=l[c];e._addRow(g.getIdentity(f),c,e._itemToObject(f),
f,a)}b.callback()},c(b,b.errback));return b},_onFetchBegin:function(a){var b=this._size[""],a=this._size[""]=parseInt(a,10);if(b!==a)this.onSizeChange(a,b)},_onFetchComplete:function(a,b,c){try{for(var g=[],l=this.store,d=0,f=c.length;d<f;++d)g.push(l.getIdentity(c[d])),this._addRow(g[d],b+d,this._itemToObject(c[d]),c[d]);a.callback(g)}catch(h){a.errback(h)}},_storeFetch:function(a){var b=this,e=b.store,g=new i,l=f({},b.options||{},a),d=c(b,b._onFetchBegin),a=c(b,b._onFetchComplete,g,a.start),h=c(g,
g.errback);b.onBeforeFetch();e.fetch?e.fetch(f(l,{onBegin:d,onComplete:a,onError:h})):(e=e.query(l.query,l),i.when(e.total,d),i.when(e,a,h));g.then(function(){b.onAfterFetch()});return g},_onSet:function(a){var b=this.store.getIdentity(a),c=this.idToIndex(b),g=this.treePath(b);g.length&&this._addRow(b,c,this._itemToObject(a),a,g.pop());this.onSet(b,c,this._cache[b])},_onNew:function(a,b){var c=this.store,g=c.getIdentity(a),l=this._itemToObject(a),l={data:this._formatRow(l),rawData:l,item:a},d=b&&
b[c.fetch?"item":"parent"];d&&c.getIdentity(d);c=this._size[""];this.clear();this.onNew(g,0,l);!d&&c>=0&&(this._size[""]=c+1,this.onSizeChange(c+1,c,"new"))},_onDelete:function(a){var b=this.store,c=this._struct,a=b.fetch?b.getIdentity(a):a,g=this.treePath(a);if(g.length){var l,d,b=[a],f=g.pop(),o=this._size,r=o[""],s=h(c[f],a);c[f].splice(s,1);--o[f];for(l=0;l<b.length;++l)if(g=c[b[l]])for(d=g.length-1;d>0;--d)b.push(g[d]);for(l=b.length-1;l>=0;--l)d=b[l],delete this._cache[d],delete c[d],delete o[d];
l=h(this._priority,a);l>=0&&this._priority.splice(l,1);this.onDelete(a,s-1);!f&&r>=0&&(o[""]=r-1,this.onSizeChange(r-1,r,"delete"))}else this.onDelete(a)}})})},"gridx/Grid":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-class","dojo/dom-geometry","dojo/_base/query","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/Grid.html","./core/Core","./core/_Module","./modules/Header","./modules/Body","./modules/VLayout","./modules/HLayout","./modules/VScroller",
"./modules/HScroller","./modules/ColumnWidth"],function(m,j,k,i,d,c,f,h,a,b,e,g,l,p,t,o,r,s){var n=j.forEach,q=function(){},m=m("gridx.Grid",[f,h,b],{templateString:a,coreModules:[g,l,p,t,o,r,s],coreExtensions:[],postMixInProperties:function(){this._eventFlags={};this.modules=this.coreModules.concat(this.modules||[]);this.modelExtensions=this.coreExtensions.concat(this.modelExtensions||[]);this._initEvents(this._compNames,this._eventNames);this.reset(this)},buildRendering:function(){this.inherited(arguments);
i.toggle(this.domNode,"gridxRtl",!this.isLeftToRight())},postCreate:function(){this.inherited(arguments);this._postCreate()},startup:function(){this._started||(this.inherited(arguments),this._deferStartup.callback())},destroy:function(){this._uninit();this.inherited(arguments)},resize:function(a){var g={};a&&(this.autoWidth&&delete a.w,this.autoHeight&&delete a.h,d.setMarginBox(this.domNode,a));this._onResizeBegin(a,g);this._onResizeEnd(a,g)},_onResizeBegin:function(){},_onResizeEnd:function(){},
_compNames:["Cell","HeaderCell","Row","Header"],_eventNames:["Click","DblClick","MouseDown","MouseUp","MouseOver","MouseOut","MouseMove","ContextMenu","KeyDown","KeyPress","KeyUp"],_initEvents:function(a,g){var b=this;n(a,function(a){n(g,function(g){g="on"+a+g;b[g]=b[g]||q})})},_connectEvents:function(a,g,b){n(this._eventNames,function(c){this.connect(a,"on"+c.toLowerCase(),k.hitch(b,g,c))},this)},_isConnected:function(a){return this[a]!==q}});m.markupFactory=function(a,g,b){if(!a.structure&&g.nodeName.toLowerCase()==
"table"){var l=a.structure=[];c("thead > tr > th",g).forEach(function(a){var g={};n(e._markupAttrs,function(b){b[0]=="!"?(b=b.slice(1),g[b]=eval(a.getAttribute(b))):g[b]=a.getAttribute(b)});g.name=g.name||a.innerHTML;l.push(g)})}return new b(a,g)};return m})},"gridx/modules/select/_Base":function(){define(["dojo/_base/declare","dojo/_base/connect","../../core/_Module"],function(m,j,k){return m(k,{getAPIPath:function(){var i={select:{}};i.select[this._type]=this;return i},preload:function(){var i=
this,d=i.grid;i.subscribe("gridClearSelection_"+d.id,function(c){c!=i._type&&i.clear()});i.connect(d.body,"onRender","_onRender");i._init()},enabled:!0,multiple:!0,holdingCtrl:!1,onSelected:function(){},onDeselected:function(){},onHighlightChange:function(){},_getMarkType:function(){},_select:function(i,d){var c=1;this.arg("enabled")&&(this.arg("multiple")&&(d||this.arg("holdingCtrl"))?c=!this.isSelected(i):this.clear(),j.publish("gridClearSelection_"+this.grid.id,[this._type]),this._markById(i,c))}})})},
"gridx/nls/Body":function(){define({root:{emptyInfo:"No items to display"}})},"gridx/modules/SingleSort":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/keys","../core/model/extensions/Sort","../core/_Module"],function(m,j,k,i,d){return d.register(m(d,{name:"sort",forced:["header"],modelExtensions:[i],getAPIPath:function(){return{sort:this}},preload:function(){var c=this,d=c.grid,h;c.connect(d,"onHeaderCellClick","_onClick");c.connect(d,"onHeaderCellKeyDown","_onKeyDown");d.persist&&
(h=d.persist.registerAndLoad("sort",function(){return[{colId:c._sortId,descending:c._sortDescend}]}));h=h||c.arg("preSort");j.isArrayLike(h)&&(h=h[0]);if(h&&h.colId)c._sortId=h.colId,c._sortDescend=h.descending,c.model.sort([h])},load:function(){var c=this,d,h=function(){c._sortId&&c._updateHeader(c._sortId,c._sortDescend)};c.connect(c.grid.header,"onRender",h);for(d in c.grid._columnsById)c._initHeader(d);h();c.loaded.callback()},columnMixin:{sort:function(c,d){this.grid.sort.sort(this.id,c,d);return this},
isSorted:function(){return this.grid.sort.isSorted(this.id)},clearSort:function(c){this.isSorted()&&this.grid.sort.clear(c);return this},isSortable:function(){var c=this.grid._columnsById[this.id];return c.sortable||c.sortable===void 0},setSortable:function(c){this.grid._columnsById[this.id].sortable=!!c;return this}},sort:function(c,d,h){var a=this.grid,b=a._columnsById[c];if(b&&(b.sortable||b.sortable===void 0))(this._sortId!=c||this._sortDescend==!d)&&this._updateHeader(c,d),this.model.sort([{colId:c,
descending:d}]),h||a.body.refresh()},isSorted:function(c){if(c==this._sortId)return this._sortDescend?-1:1;return 0},clear:function(c){if(this._sortId!==null)this._initHeader(this._sortId),this._sortId=this._sortDescend=null,this.model.sort(),c||this.grid.body.refresh()},getSortData:function(){return this._sortId?[{colId:this._sortId,descending:this._sortDescend}]:null},_sortId:null,_sortDescend:null,_initHeader:function(c){var d=this.grid.header.getHeaderNode(c);d.innerHTML=["<div class='gridxSortNode'>",
this.grid.column(c,1).name(),"</div>"].join("");d.removeAttribute("aria-sort")},_updateHeader:function(c,d){this._sortId&&this._sortId!=c&&this._initHeader(this._sortId);this._sortId=c;this._sortDescend=!!d;var h=this.grid,a=h.header.getHeaderNode(c);a.innerHTML=["<div class='gridxSortNode ",d?"gridxSortDown":"gridxSortUp","'><div class='gridxArrowButtonChar'>",d?"&#9662;":"&#9652;","</div><div role='presentation' class='gridxArrowButtonNode'></div><div class='gridxColCaption'>",h.column(c,1).name(),
"</div></div>"].join("");a.setAttribute("aria-sort",d?"descending":"ascending");h.vLayout.reLayout()},_onClick:function(c){this.sort(c.columnId,this._sortId!=c.columnId?0:!this._sortDescend)},_onKeyDown:function(c){c.keyCode==k.ENTER&&this._onClick(c)}}))})},"gridx/modules/select/_RowCellBase":function(){define(["dojo/_base/declare","dojo/_base/lang","./_Base","../../core/model/extensions/Mark"],function(m,j,k,i){return m(k,{modelExtensions:[i],selectById:function(d,c){var f=this.model;this.arg("enabled")&&
(f.markById(d,1,this._getMarkType(c)),f.when())},deselectById:function(d,c){var f=this.model;this.arg("enabled")&&(f.markById(d,0,this._getMarkType(c)),f.when())},isSelected:function(d,c){return this.model.isMarked(d,this._getMarkType(c))},_init:function(){var d=this.model;this.batchConnect([d,"onMarked",j.hitch(this,"_onMark",1)],[d,"onMarkRemoved",j.hitch(this,"_onMark",0)])}})})},"gridx/modules/HScroller":function(){define(["dojo/_base/declare","dojo/dom-style","dojo/_base/sniff","dojo/_base/Deferred",
"dojox/html/metrics","../core/_Module"],function(m,j,k,i,d,c){return c.register(m(c,{name:"hScroller",forced:["header"],getAPIPath:function(){return this.grid.autoWidth?{}:{hScroller:this}},constructor:function(){this.grid._initEvents(["H"],["Scroll"])},preload:function(){var c=this,h=c.grid,a=h.hScrollerNode;if(!h.autoWidth&&(c.domNode=a,c.container=a.parentNode,c.stubNode=a.firstChild,h.vLayout.register(c,"container","footerNode",0),a.style.display="block",c.batchConnect([h.header,"onRender","refresh"],
[a,"onscroll","_onScroll"],[h,"_onResizeBegin",function(a,c){c.hScroller=new i}],[h,"_onResizeEnd",function(a,d){i.when(d.header,function(){c.refresh();d.hScroller.callback()})}]),k("ie")))a.style.height=d.getScrollbar().h+"px"},scroll:function(c){this.domNode.scrollLeft=c},refresh:function(){var c=this.grid,d=c.isLeftToRight(),a=d?"marginLeft":"marginRight",d=d?"marginRight":"marginLeft",b=c.hLayout.lead,e=c.hLayout.tail,g=(c.domNode.clientWidth||j.get(c.domNode,"width"))-b-e,l=c.header.innerNode,
p=j.get(l,"paddingLeft")||0,t=this.domNode.style,l=l.firstChild.offsetWidth+p,o=t.display,r=l<=g?"none":"block";t[a]=b+p+"px";t[d]=e+"px";t.width=(g-p<0?0:g-p)+"px";this.stubNode.style.width=(l-p<0?0:l-p)+"px";t.display=r;o=="block"&&r=="none"&&c.vLayout.reLayout()},_lastLeft:0,_onScroll:function(){var c=this.domNode.scrollLeft;if(this._lastLeft!=c)this._lastLeft=c,this._doScroll()},_doScroll:function(){var c=this.grid;c.onHScroll(c.bodyNode.scrollLeft=this.domNode.scrollLeft)}}))})},"gridx/core/model/cache/Sync":function(){define(["dojo/_base/declare",
"dojo/_base/Deferred","./_Cache"],function(m,j,k){return m(k,{keep:function(){},free:function(){},when:function(i,d){var c=new j;try{d&&d(),c.callback()}catch(f){c.errback(f)}return c},prepare:function(){this._size[""]<0&&(this._storeFetch({start:0}),this.store.getChildren&&this._fetchChildren())},_fetchChildren:function(){for(var i=this._struct,d=i[""].slice(1),c;d.length;)c=d.shift(),this._loadChildren(c).then(function(){[].push.apply(d,i[c].slice(1))})}})})},"gridx/modules/HLayout":function(){define(["dojo/_base/declare",
"dojo/_base/Deferred","dojo/_base/array","dojo/dom-geometry","dojo/dom-style","dojo/DeferredList","../core/_Module"],function(m,j,k,i,d,c,f){return f.register(m(f,{name:"hLayout",getAPIPath:function(){return{hLayout:this}},load:function(c,a){var b=this;a.then(function(){b._layout();b.loaded.callback()})},lead:0,tail:0,register:function(c,a,b){var d=this._regs=this._regs||[];c||(c=new j,c.callback());d.push([c,a,b])},onUpdateWidth:function(){},_layout:function(){var f=this,a=f._regs;if(a){var b=0,
e=0,g=k.map(a,function(a){return a[0]});(new c(g)).then(function(){k.forEach(a,function(a){var g=i.getMarginBox(a[1]).w||d.get(a[1],"width");a[2]?e+=g:b+=g});f.lead=b;f.tail=e;f.onUpdateWidth(b,e)})}else f.onUpdateWidth(0,0)}}))})},"gridx/core/Cell":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred"],function(m,j,k){return m([],{constructor:function(i,d,c){this.grid=i;this.model=i.model;this.row=d;this.column=c},data:function(){return this.model.byId(this.row.id).data[this.column.id]},
rawData:function(){var i=this.column.field();return i&&this.model.byId(this.row.id).rawData[i]},setRawData:function(i){var d=new k,c=this.column.field(),f=this.grid.store,h=j.hitch,a=h(d,d.callback),h=h(d,d.errback);if(c){var b=this.model.byId(this.row.id).item;f.setValue?(f.setValue(b,c,i),f.save({onComplete:a,onError:h})):f.put&&(b=j.clone(b),b[c]=i,k.when(f.put(b),a,h))}else a();return d}})})},"gridx/core/model/extensions/Mark":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/Deferred",
"../_Extension"],function(m,j,k,i){return m(i,{name:"move",priority:5,constructor:function(d){this.clear();this._mixinAPI("isMarked","getMarkedIds","markById","markByIndex","clearMark");d.onMarked=function(){};d.onMarkRemoved=function(){};this.connect(d,"_msg","_receiveMsg");d._spTypes={}},clear:function(){this._byId={}},clearMark:function(d){this._byId[this._initMark(d)]={}},getMarkedIds:function(d){var c=[],f;if(d=this._byId[this._initMark(d)])for(f in d)c.push(f);return c},isMarked:function(d,
c){return!!this._byId[this._initMark(c)][d]},markById:function(d,c,f){this._cmd(d,c,f,1)},markByIndex:function(d,c,f){d>=0&&d<Infinity&&this._cmd(d,c,f)},_mark:function(d,c,f){var f=this._initMark(f),h=this.isMarked(d,f);c&&!h?this._addMark(d,f):!c&&h&&this._removeMark(d,f)},_cmdMark:function(){var d=this,c=arguments,f=[],h=d.model._model;j.forEach(c,function(a){a[3]||f.push({start:a[0],count:1})});return h._call("when",[{id:[],range:f},function(){j.forEach(c,function(a){a[3]||(a[0]=h._call("indexToId",
[a[0]]));a[0]&&d._mark.apply(d,a)})}])},_onDelete:function(d){var c,f=this._byId;for(c in f)delete f[this._initMark(c)][d];this.onDelete.apply(this,arguments)},_initMark:function(d){var c=this._byId,d=d||"select";c[d]=c[d]||{};return d},_addMark:function(d,c){var f=this._initMark(c);this._byId[f][d]=1;this.model.onMarked(d,f)},_removeMark:function(d,c){var f=this._initMark(c);delete this._byId[f][d];this.model.onMarkRemoved(d,f)},_cmd:function(){this.model._addCmd({name:"_cmdMark",scope:this,args:arguments,
async:1})},_receiveMsg:function(d,c){if(d=="filter"){var f,h=this.model._spTypes,a;for(f in h)if(h[f])for(a in this._byId[f])c[a]||this._removeMark(a,f)}}})})},"gridx/modules/Body":function(){define(["dojo/_base/declare","dojo/_base/query","dojo/_base/array","dojo/dom-construct","dojo/dom-class","dojo/_base/Deferred","dojo/_base/sniff","dojo/keys","../core/_Module","../util","dojo/i18n!../nls/Body"],function(m,j,k,i,d,c,f,h,a,b,e){return a.register(m(a,{name:"body",optional:["tree"],getAPIPath:function(){return{body:this}},
preload:function(){var a=this.grid,b=this.domNode=a.bodyNode;a._connectEvents(b,"_onMouseEvent",this);this._initFocus()},load:function(){var a=this,b=a.model,c=a.grid;a.batchConnect([b,"onDelete","_onDelete"],[b,"onSet","_onSet"],[b,"onSizeChange","_onSizeChange"],[c,"onRowMouseOver","_onRowMouseOver"],[c,"onCellMouseOver","_onCellMouseOver"],[c,"onCellMouseOut","_onCellMouseOver"],[c.bodyNode,"onmouseleave",function(){var b=j(".gridxRowOver",a.domNode)[0];b&&d.remove(b,"gridxRowOver")}],[c,"setColumns",
function(){a.refresh()}]);b.when({},function(){var d=a.rootCount,d=a.rootCount=d?d:b.size();a.visualCount=c.tree?c.tree.getVisualSize(a.rootStart,d):d;a.loaded.callback()})},destroy:function(){this.inherited(arguments);this.domNode.innerHTML=""},rowMixin:{node:function(){return this.grid.body.getRowNode({rowId:this.id})},visualIndex:function(){var a=this.id;return this.grid.body.getRowInfo({rowId:a,rowIndex:this.index(),parentId:this.model.treePath(a).pop()}).visualIndex}},cellMixin:{node:function(){return this.grid.body.getCellNode({rowId:this.row.id,
cellId:this.column.id})}},getRowNode:function(a){return(a=this._getRowNodeQuery(a))?j(a,this.domNode)[0]||null:null},getCellNode:function(a){var b=a.colId,c=this._getRowNodeQuery(a);if(c){if(!b&&typeof a.colIndex=="number")b=this.grid._columns[a.colIndex].id;c+=" [colid='"+b+"'].gridxCell";return j(c,this.domNode)[0]||null}return null},getRowInfo:function(a){var b=this.model,c=this.grid,d=a.rowId;if(d)a.rowIndex=b.idToIndex(d),a.parentId=b.treePath(d).pop();if(typeof a.rowIndex=="number"&&a.rowIndex>=
0)a.visualIndex=c.tree?c.tree.getVisualIndexByRowInfo(parentId,rowIndex,this.rootStart):a.rowIndex-this.rootStart;else if(typeof a.visualIndex=="number"&&a.visualIndex>=0)c.tree?(c=c.tree.getRowInfoByVisualIndex(a.visualIndex,this.rootStart),a.rowIndex=c.start,a.parentId=c.parentId):a.rowIndex=this.rootStart+a.visualIndex;else return a;a.rowId=d||b.indexToId(a.rowIndex,a.parentId);return a},refresh:function(a){var b=this;return b.model.when({}).then(function(){var d=b.renderStart,e=b.renderCount;
if(typeof a=="number"&&a>=0){a=d>a?d:a;var f=d+e-a,d=j('[visualindex="'+a+'"]',b.domNode)[0],e=[],r=[];if(d){var h=b._buildRows(a,f,e,r);if(h){i.place(h,d,"before");for(var h=0,n=r.length;h<n;++h)b.onAfterRow.apply(b,r[h])}}for(;d;)r=d.nextSibling,i.destroy(d),d=r;c.when(b._buildUncachedRows(e),function(){b.onRender(a,f)})}else b.renderRows(d,e,0,1)})},refreshCell:function(a,b){var d=new c,e=this,f=e.model,r=e.grid,h=r._columns[b],n=h&&e.getCellNode({visualIndex:a,colId:h.id});if(n){var q,i=e.getRowInfo({visualIndex:a}),
j=i.rowIndex,k=i.parentId;f.when({start:j,count:1,parentId:k},function(){if(q=f.byIndex(j,k))i.rowId=f.indexToId(j,k),n.innerHTML=e._buildCellContent(h,i,q.data,r.tree&&q.data[h.id]===void 0),e.onAfterCell(n,i,h,q)}).then(function(){d.callback(!!q)});return d}d.callback(0);return d},rootStart:0,rootCount:0,renderStart:0,renderCount:0,visualStart:0,visualCount:0,autoUpdate:1,autoChangeSize:1,updateRootRange:function(a,b){var c=this.grid.tree,c=this.visualCount=c?c.getVisualSize(a,b):b;this.rootStart=
a;this.rootCount=b;if(this.renderStart+this.renderCount>c&&(this.renderStart=c-this.renderCount,this.renderStart<0))this.renderStart=0,this.renderCount=c;if(!this.renderCount&&c)this.onForcedScroll()},renderRows:function(a,b,d,h){var o=this,r=o.grid,s="",n=[],q=[],j=o.domNode,k=r.emptyNode;if(b>0){k.innerHTML="";d!="top"&&d!="bottom"&&o.model.free();s=o._buildRows(a,b,n,q);if(d=="top")o.renderCount+=o.renderStart-a,o.renderStart=a,i.place(s,j,"first");else if(d=="bottom")o.renderCount=a+b-o.renderStart,
i.place(s,j,"last");else{o.renderStart=a;o.renderCount=b;d=h?j.scrollTop:0;j.scrollTop=0;if(f("ie"))for(;j.childNodes.length;)j.removeChild(j.firstChild);j.innerHTML=s;j.scrollTop=d;j.scrollLeft=r.hScrollerNode.scrollLeft;k.innerHTML=s?"":e.emptyInfo;o.onUnrender()}r=0;for(s=q.length;r<s;++r)o.onAfterRow.apply(o,q[r]);c.when(o._buildUncachedRows(n),function(){o.onRender(a,b)})}else if(!{top:1,bottom:1}[d])j.scrollTop=0,j.innerHTML="",k.innerHTML=e.emptyInfo,o.onUnrender(),o.model.free()},unrenderRows:function(a,
b){if(a>0){var c=0,d,e=this.domNode;if(b=="post")for(;c<a&&e.lastChild;++c)d=e.lastChild.getAttribute("rowid"),this.model.free(d),e.removeChild(e.lastChild),this.onUnrender(d);else{for(var f=e.scrollTop;c<a&&e.firstChild;++c)d=e.firstChild.getAttribute("rowid"),this.model.free(d),f-=e.firstChild.offsetHeight,e.removeChild(e.firstChild),this.onUnrender(d);this.renderStart+=c;e.scrollTop=f>0?f:0}this.renderCount-=c;this.model.when()}},onAfterRow:function(){},onAfterCell:function(){},onRender:function(){},
onUnrender:function(){},onDelete:function(){},onSet:function(){},collectCellWrapper:function(){},onMoveToCell:function(){},onForcedScroll:function(){},_getRowNodeQuery:function(a){var b;a.rowId?b="[rowid='"+a.rowId+"']":typeof a.rowIndex=="number"&&a.rowIndex>=0?(b="[rowindex='"+a.rowIndex+"']",a.parentId&&(b+="[parentid='"+a.parentId+"']")):typeof a.visualIndex=="number"&&a.visualIndex>=0&&(b="[visualindex='"+a.visualIndex+"']");return b&&b+".gridxRow"},_buildRows:function(a,b,c,d){for(var b=a+b,
e=[],f=this.model,h=this.domNode.scrollWidth;a<b;++a){var n=this.getRowInfo({visualIndex:a}),q=f.byIndex(n.rowIndex,n.parentId);e.push('<div class="gridxRow ',a%2?"gridxRowOdd":"",'" role="row" visualindex="',a);q?(f.keep(n.rowId),e.push('" rowid="',n.rowId,'" rowindex="',n.rowIndex,'" parentid="',n.parentId,'">',this._buildCells(q.data,n),"</div>"),d.push([n,q])):(e.push('"><div class="gridxRowDummy" style="width:',h,'px;"></div></div>'),n.start=n.rowIndex,n.count=1,c.push(n))}return e.join("")},
_buildUncachedRows:function(a){return a.length&&this.model.when(a,function(){for(var b=0,c=a.length;b<c;++b)this._buildRowContent(a[b])},this)},_buildRowContent:function(a){var b=this.model,c=j('[visualindex="'+a.visualIndex+'"]',this.domNode)[0];if(c){var d=b.byIndex(a.rowIndex,a.parentId);d?(a.rowId=b.indexToId(a.rowIndex,a.parentId),b.keep(a.rowId),c.setAttribute("rowid",a.rowId),c.setAttribute("rowindex",a.rowIndex),c.setAttribute("parentid",a.parentId||""),c.innerHTML=this._buildCells(d.data,
a),this.onAfterRow(a,d)):console.error("Row is not in cache:",a.rowIndex)}},_buildCells:function(a,b){for(var c,d,e=this.grid,f=e._columns,h=e.focus&&e.focus.currentArea()=="body",n=['<table class="gridxRowTable" role="presentation" border="0" cellpadding="0" cellspacing="0"><tr>'],q=0,i=f.length;q<i;++q)c=f[q],d=e.tree&&a[c.id]===void 0,n.push('<td class="gridxCell '),d&&n.push("gridxPaddingCell"),h&&this._focusCellRow===b.visualIndex&&this._focusCellCol===q&&n.push("gridxCellFocus"),n.push('" role="gridcell" tabindex="-1" colid="',
c.id,'" style="width: ',c.width,'">',this._buildCellContent(c,b,a,d),"</td>");n.push("</tr></table>");return n.join("")},_buildCellContent:function(a,b,c,d){var e="";d||(e=this._wrapCellData(a.decorator?a.decorator(c[a.id],b.rowId,b.visualIndex):c[a.id],b.rowId,a.id));return!e&&f("ie")<8?"$nbsp;":e},_wrapCellData:function(a,b,c){var d=[];this.collectCellWrapper(d,b,c);var e=d.length-1;for(e>0&&d.sort(function(a,b){return a.priority-b.priority});e>=0;--e)a=d[e].wrap(a,b,c);return a},_onMouseEvent:function(a,
b){var c=this.grid,d="onCell"+a,e="onRow"+a;if(c._isConnected(d)||c._isConnected(e))if(this._decorateEvent(b),b.rowId){if(b.columnId)c[d](b);c[e](b)}},_decorateEvent:function(a){for(var b=a.target||a.originalTarget,c=this.grid,e;b&&b!=c.bodyNode;b=b.parentNode){e=b.tagName.toLowerCase();if(e=="td"&&d.contains(b,"gridxCell")){var f=c._columnsById[b.getAttribute("colid")];a.cellNode=b;a.columnId=f.id;a.columnIndex=f.index}if(e=="div"&&d.contains(b,"gridxRow")){a.rowId=b.getAttribute("rowid");a.parentId=
b.getAttribute("parentid");a.rowIndex=parseInt(b.getAttribute("rowindex"),10);a.visualIndex=parseInt(b.getAttribute("visualindex"),10);break}}},_onSet:function(a,b,c){if(this.autoUpdate){var d=this.getRowNode({rowId:a});if(d&&c){var e=this.getRowInfo({rowId:a,rowIndex:b});d.innerHTML=this._buildCells(c.data,e);this.onAfterRow(e,c);this.onSet(a,b,c);this.onRender(b,1)}}},_onDelete:function(a){if(this.autoUpdate){var b=this.getRowNode({rowId:a});if(b){for(var c=0,d=parseInt(b.getAttribute("rowindex"),
10),e=b.getAttribute("parentid"),f={id:1},h=[b],n,q=[a],b=b.nextSibling;b&&f[b.getAttribute("parentid")];b=b.nextSibling)n=b.getAttribute("rowid"),q.push(n),h.push(b),f[n]=1;for(;b;b=b.nextSibling)b.getAttribute("parentid")==e&&b.setAttribute("rowindex",parseInt(b.getAttribute("rowindex"),10)-1),b.setAttribute("visualindex",parseInt(b.getAttribute("visualindex"),10)-1),++c;k.forEach(h,i.destroy);k.forEach(q,this.onUnrender,this);this.autoChangeSize&&this.rootStart===0&&!e&&this.updateRootRange(0,
this.rootCount-1);this.onDelete(a,d);this.onRender(d,c)}}},_onSizeChange:function(a,b){if(this.autoChangeSize&&this.rootStart===0&&(this.rootCount===b||b<0))this.updateRootRange(0,a),this._started&&this.refresh(),this._started=1},_onRowMouseOver:function(a){var b=j("> div.gridxRowOver",this.domNode)[0],a=this.getRowNode({rowId:a.rowId});b!=a&&(b&&d.remove(b,"gridxRowOver"),d.add(a,"gridxRowOver"))},_onCellMouseOver:function(a){d.toggle(a.cellNode,"gridxCellOver",a.type=="mouseover")},_focusCellCol:0,
_focusCellRow:0,_initFocus:function(){var a=this,b=a.grid,c=b.bodyNode,d=b.focus;d&&(d.registerArea({name:"body",priority:1,focusNode:c,scope:a,doFocus:a._doFocus,doBlur:a._blurCell,onFocus:a._onFocus,onBlur:a._blurCell}),a.connect(b.mainNode,"onkeypress",function(c){if(d.currentArea()=="body"&&(!b.tree||!c.ctrlKey)){var e={},f=b.isLeftToRight()?1:-1;e[h.LEFT_ARROW]=[0,-f,c];e[h.RIGHT_ARROW]=[0,f,c];e[h.UP_ARROW]=[-1,0,c];e[h.DOWN_ARROW]=[1,0,c];a._moveFocus.apply(a,e[c.keyCode]||[])}}),a.connect(b,
"onCellClick",function(b){a._focusCellRow=b.visualIndex;a._focusCellCol=b.columnIndex}),a.connect(a,"onRender",function(b,c){a._focusCellRow>=b&&a._focusCellRow<b+c&&d.currentArea()=="body"&&a._focusCell()}),b.hScroller&&a.connect(c,"onscroll",function(){b.hScroller.scroll(c.scrollLeft)}))},_doFocus:function(a){return this._focusCell(a)||this._focusCell(0,0,0)},_focusCell:function(a,c,e){b.stopEvent(a);e=e>=0?e:this._focusCellCol;c=c>=0?c:this._focusCellRow;if(a=this.getCellNode({visualIndex:c,colId:this.grid._columns[e].id})){var h=
j(".gridxCellFocus",this.domNode)[0];if(a!=h)h&&d.remove(h,"gridxCellFocus"),d.add(a,"gridxCellFocus"),this._focusCellRow=c,this._focusCellCol=e;f("ie")<8||a.focus()}return a},_moveFocus:function(a,c,d){if(a||c){b.stopEvent(d);var e,f,h=this,i=h.grid,n=i._columns,q=h.visualCount;e=h._focusCellRow+a;e=e<0?0:e>=q?q-1:e;f=h._focusCellCol+c;f=f<0?0:f>=n.length?n.length-1:f;i.vScroller.scrollToRow(e).then(function(){h._focusCell(0,e,f);h.onMoveToCell(e,f,d)})}},_nextCell:function(a,b,d,e){var f=new c,
h=this.grid,i=h._columns.length,n=this.visualCount;do if(b+=d,b<0||b>=i)a+=d,b=b<0?i-1:0,a<0?(a=n-1,b=i-1):a>=n&&(b=a=0);while(!e(a,b));h.vScroller.scrollToRow(a).then(function(){f.callback({r:a,c:b})});return f},_blurCell:function(){var a=j(".gridxCellFocus",this.domNode)[0];a&&d.remove(a,"gridxCellFocus");return!0},_onFocus:function(a){for(a=a.target;a&&a!=this.domNode;a=a.parentNode)if(d.contains(a,"gridxCell")){for(var b=this.grid._columnsById[a.getAttribute("colid")].index;!d.contains(a,"gridxRow");)a=
a.parentNode;return this._focusCell(0,parseInt(a.getAttribute("visualindex"),10),b)}return!1}}))})},"gridx/modules/select/Row":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/sniff","dojo/dom-class","dojo/keys","./_RowCellBase","../../core/_Module"],function(m,j,k,i,d,c,f){return f.register(m(c,{name:"selectRow",rowMixin:{select:function(){this.grid.select.row.selectById(this.id);return this},deselect:function(){this.grid.select.row.deselectById(this.id);return this},isSelected:function(){return this.model.isMarked(this.id)}},
triggerOnCell:!1,getSelected:function(){return this.model.getMarkedIds()},clear:function(){if(this.arg("enabled")){var c=this.model;j.forEach(c.getMarkedIds(),function(a){c.markById(a,0)});c.when()}},_type:"row",_init:function(){var c=this,a=c.grid;c.inherited(arguments);c.model._spTypes.select=1;c.batchConnect([a,"onRowMouseDown",function(a){(c.arg("triggerOnCell")||!a.columnId)&&c._select(a.rowId,a.ctrlKey)}],[a,k("ff")<4?"onRowKeyUp":"onRowKeyDown",function(a){(c.arg("triggerOnCell")||!a.columnId)&&
a.keyCode==d.SPACE&&c._select(a.rowId,a.ctrlKey)}])},_onMark:function(c,a,b){if(b=="select"){var d=this;d._highlight(a,c);d.model.when({id:a},function(){d[c?"onSelected":"onDeselected"](d.grid.row(a,!0))})}},_highlight:function(c,a){var b=this.grid.body.getRowNode({rowId:c});b&&(i.toggle(b,"gridxRowSelected",a),this.onHighlightChange({row:parseInt(b.getAttribute("visualindex"),10)},!!a))},_markById:function(c,a){var b=this.model;b.markById(c,a);b.when()},_onRender:function(c,a){var b=this.model,d=
c+a,g,f;for(g=c;g<d;++g)f=b.indexToId(this.grid.body.getRowInfo({visualIndex:g}).rowIndex),b.isMarked(f)&&this._highlight(f,1)}}))})},"gridx/core/Column":function(){define(["dojo/_base/declare"],function(m){return m([],{constructor:function(j,k){this.grid=j;this.model=j.model;this.id=k},index:function(){var j=this.grid._columnsById[this.id];return j?j.index:-1},cell:function(j,k){return this.grid.cell(j,this,k)},name:function(){return this.grid._columnsById[this.id].name||""},setName:function(j){this.grid._columnsById[this.id].name=
j;return this},field:function(){return this.grid._columnsById[this.id].field||null},getWidth:function(){return this.grid._columnsById[this.id].width}})})},"gridx/modules/ColumnWidth":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/Deferred","dojo/_base/query","dojo/_base/sniff","dojo/dom-geometry","dojo/dom-class","dojo/dom-style","dojo/keys","../core/_Module"],function(m,j,k,i,d,c,f,h,a,b){return b.register(m(b,{name:"columnWidth",forced:["hLayout","header"],getAPIPath:function(){return{columnWidth:this}},
constructor:function(){this._ready=new k},preload:function(){var a=this,b=a.grid;if(!b.hScroller)a.autoResize=!0;a.batchConnect([b,"_onResizeBegin",function(c,d){d.header=new k;if(a.arg("autoResize")){var f=b.domNode.clientWidth-b.hLayout.lead-b.hLayout.tail;b.bodyNode.style.width=(f<0?0:f)+"px"}else a._adaptWidth();d.header.callback()}],[b.hLayout,"onUpdateWidth",function(){a._adaptWidth();a._ready.callback()}],[b,"setColumns","_adaptWidth"])},load:function(){var a=this.loaded;this._ready.then(function(){a.callback()})},
"default":60,autoResize:!1,_adaptWidth:function(){var a=this,b=a.grid,l=b.domNode,k=b.header,m=b.isLeftToRight(),o=m?"marginLeft":"marginRight",r=m?"marginRight":"marginLeft",m=b.hLayout.lead,s=b.hLayout.tail,n=k.innerNode,q=b.bodyNode.style,z=n.style,u=(l.clientWidth||h.get(l,"width"))-m-s,v=i(".gridxCell",n)[0],w=c.getMarginBox(v).w-c.getContentBox(v).w,A=!l.offsetHeight,v=h.get(v,"borderCollapse")=="collapse";z[o]=q[o]=m+"px";z[r]=s+"px";u=u<0?0:u;A&&v&&w--;if(b.autoWidth){j.forEach(b._columns,
function(b){if(!b.width)b.width=a.arg("default")+"px"});k.refresh();var o=i("th.gridxCell",n),x=v?2:0;o.forEach(function(a){var c=h.get(a,"width");if(!d("webkit")||!A)c+=w;x+=c;a=b._columnsById[a.getAttribute("colid")];if(!a.width||/%$/.test(a.width))a.width=c+"px"});k._columnsWidth=x;q.width=x+"px";l.style.width=m+s+x+"px"}else{if(a.arg("autoResize"))q.width=u+"px",f.add(l,"gridxPercentColumnWidth"),j.forEach(b._columns,function(a){if(!a.width||!/%$/.test(a.width))a.width="auto"});else{var y=[],
B=v?2:0;q.width=u+"px";j.forEach(b._columns,function(a){if(!a.width||a.width=="auto")a.width="auto",y.push(a);else if(/%$/.test(a.width))a.width=parseInt(u*parseFloat(a.width,10)/100-w,10)+"px"});try{k.refresh()}catch(D){alert(D)}j.forEach(b._columns,function(a){if(a.width!="auto"){var b=h.get(k.getHeaderNode(a.id),"width");if(!a.width||/%$/.test(a.width))a.width=b+"px";if(!d("webkit")||!A)b+=w;B+=b}});if(y.length){d("webkit")&&(w=0);var C=u>B?(u-B)/y.length-w:a.arg("default"),C=parseInt(C,10)+"px";
j.forEach(y,function(a){a.width=C})}}k.refresh()}if(d("ie")<8)z.width=u+"px";b.hScroller&&(b.hScroller.scroll(0),k._onHScroll(0))}}))})},"gridx/modules/Header":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/dom-geometry","dojo/_base/query","dojo/keys","../util","../core/_Module"],function(m,j,k,i,d,c,f,h){return h.register(m(h,{name:"header",required:["vLayout"],forced:["hLayout"],getAPIPath:function(){return{header:this}},constructor:function(){var a=this.domNode=
j.create("div",{"class":"gridxHeaderRow",role:"presentation"}),b=this.innerNode=j.create("div",{"class":"gridxHeaderRowInner",role:"row",innerHTML:'<table border="0" cellpadding="0" cellspacing="0"><tr><th class="gridxCell"></th></tr></table>'});a.appendChild(b)},preload:function(){var a=this.grid,b=this.domNode;a.headerNode.appendChild(b);a.vLayout.register(this,"domNode","headerNode");this.batchConnect([a,"onHScroll","_onHScroll"],[a,"onHeaderCellMouseOver","_onHeaderCellMouseOver"],[a,"onHeaderCellMouseOut",
"_onHeaderCellMouseOver"],a.columnResizer&&[a.columnResizer,"onResize","_onColumnResize"]);this._initFocus();a._connectEvents(b,"_onMouseEvent",this)},destroy:function(){this.inherited(arguments);j.destroy(this.domNode)},columnMixin:{headerNode:function(){return this.grid.header.getHeaderNode(this.id)}},getHeaderNode:function(a){return d("[colid='"+a+"']",this.domNode)[0]},refresh:function(){var a=this,b=a.grid,c=b.focus,d=['<table role="presentation" border="0" cellpadding="0" cellspacing="0"><tr>'];
b.columns().forEach(function(b){d.push('<th colid="',b.id,'" class="gridxCell ',c&&c.currentArea()=="header"&&b.id==a._focusHeaderId?a._focusClass:"",'" role="columnheader" aria-readonly="true" tabindex="-1" style="width: ',b.getWidth(),'"><div class="gridxSortNode">',b.name(),"</div></th>")});d.push("</tr></table>");a.innerNode.innerHTML=d.join("");a._onHScroll(a._scrollLeft);a.onRender()},onRender:function(){},onMoveToHeaderCell:function(){},_scrollLeft:0,_onColumnResize:function(a,b,c){a=this.grid;
a.autoWidth?(b=this._columnsWidth+=b-c,a.bodyNode.style.width=b+"px",a.domNode.style.width=a.hLayout.lead+a.hLayout.tail+b+"px"):this._onHScroll(a.hScrollerNode.scrollLeft)},_onHScroll:function(a){var b=this.grid.isLeftToRight();this.innerNode.firstChild.style[b?"marginLeft":"marginRight"]=(b?-a:a)+"px";this._scrollLeft=a},_onMouseEvent:function(a,b){var c=this.grid,d="onHeaderCell"+a,f="onHeader"+a;if(c._isConnected(d)||c._isConnected(f)){this._decorateEvent(b);if(b.columnIndex>=0)c[d](b);c[f](b)}},
_decorateEvent:function(a){for(var b=a.target;b&&b!==this.domNode;b=b.parentNode)if(b.tagName.toLowerCase()=="th"){if(b=this.grid._columnsById[b.getAttribute("colid")])a.columnId=b.id,a.columnIndex=b.index;break}},_onHeaderCellMouseOver:function(a){k.toggle(this.getHeaderNode(a.columnId),"gridxHeaderCellOver",a.type=="mouseover")},_focusHeaderId:null,_focusClass:"gridxHeaderCellFocus",_initFocus:function(){var a=this,b=a.grid;b.focus&&b.focus.registerArea({name:"header",priority:0,focusNode:a.domNode,
scope:a,doFocus:a._doFocus,doBlur:a._blurNode,onBlur:a._blurNode,connects:[a.connect(a.domNode,"onkeydown","_onKeyDown"),a.connect(b,"onHeaderCellMouseDown",function(b){a._focusNode(a.getHeaderNode(b.columnId))})]})},_doFocus:function(a){var b=this._focusNode(this._focusHeaderId&&this.getHeaderNode(this._focusHeaderId)||d("th.gridxCell",this.domNode)[0]);f.stopEvent(b&&a);return b},_focusNode:function(a){if(a){var b=this.grid;if(this._focusHeaderId=a.getAttribute("colid")){this._blurNode();if(b.hScroller){var c=
i.position(a),d=i.position(this.domNode),f=c.x+c.w-d.x-d.w;f<0&&(f=c.x-d.x,f>0&&(f=0));f+=this._scrollLeft;this._onHScroll(f);b.hScroller.scroll(f)}k.add(a,this._focusClass);a.focus();return!0}}return!1},_blurNode:function(){var a=d("th."+this._focusClass,this.domNode)[0];a&&k.remove(a,this._focusClass);return!0},_onKeyDown:function(a){var b=this.grid,d;d=b.isLeftToRight()?1:-1;var g=a.keyCode==c.LEFT_ARROW?-d:d;if(this._focusHeaderId&&(a.keyCode==c.LEFT_ARROW||a.keyCode==c.RIGHT_ARROW))if(f.stopEvent(a),
d=b._columnsById[this._focusHeaderId],d=b._columns[d.index+g])this._focusNode(this.getHeaderNode(d.id)),this.onMoveToHeaderCell(d.id,a)}}))})},"gridx/core/Row":function(){define(["dojo/_base/declare"],function(m){return m([],{constructor:function(j,k){this.grid=j;this.model=j.model;this.id=k},index:function(){return this.model.idToIndex(this.id)},cell:function(j,k){return this.grid.cell(this,j,k)},data:function(){return this.model.byId(this.id).data},rawData:function(){return this.model.byId(this.id).rawData},
item:function(){return this.model.byId(this.id).item}})})},"url:gridx/templates/Grid.html":'<div class="gridx" role="grid" tabindex="0"\r\n\t><div class="gridxHeader" role="presentation" data-dojo-attach-point="headerNode"></div\r\n\t><div class="gridxMain" role="presentation" data-dojo-attach-point="mainNode"\r\n\t\t><div class="gridxBodyEmpty" data-dojo-attach-point="emptyNode"></div\r\n\t\t><div class="gridxBody" role="presentation" data-dojo-attach-point="bodyNode"></div\r\n\t\t><div class="gridxVScroller" data-dojo-attach-point="vScrollerNode"\r\n\t\t\t><div style=\'width: 1px;\'></div\r\n\t\t></div\r\n\t></div\r\n\t><div class="gridxFooter" data-dojo-attach-point="footerNode"\r\n\t\t><div class="gridxHScroller"\r\n\t\t\t><div class="gridxHScrollerInner" data-dojo-attach-point="hScrollerNode"><div style="width:1px; height: 1px;"></div></div\r\n\t\t></div\r\n\t></div\r\n\t><span data-dojo-attach-point="lastFocusNode" tabindex="0"></span\r\n></div>\r\n',
"gridx/core/Core":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/Deferred","dojo/DeferredList","./model/Model","./Row","./Column","./Cell","./_Module"],function(m,j,k,i,d,c,f,h,a,b){function e(a){a=a.moduleClass.prototype;return(a.forced||[]).concat(a.optional||[])}function g(a,b){if(b)for(var c in b){var d=a[c],e=b[c];d&&k.isObject(d)&&!t(d)?g(d,e):a[c]=e}}function l(a){var b=a.modules,c,d,f,g,h=function(a){for(var c=b.length-1;c>=0;--c)if(b[c].moduleClass.prototype.name===
a)return b[c];return null};for(c=b.length-1;d=b[c];--c){f=d.moduleClass.prototype.name;for(g=e(d);g.length;){d=g.shift();if(d==f)throw Error("Module '"+d+"' is in a dependancy circle!");(d=h(d))&&(g=g.concat(e(d)))}}return a}var p=k.delegate,t=k.isFunction,o=k.hitch;return m([],{reset:function(a){this._uninit();var d={},e;for(e in a)d[e]=a[e];a=d;this.store=a.store;a.modules=a.modules||[];a.modelExtensions=a.modelExtensions||[];this.setColumns(a.structure);a.columns=this._columnsById;e=a;var f=this.coreModules,
g,h,a=e.modules,d=[],i=f&&f.length||0,f=0;for(g=a.length;f<g;++f)h=a[f],t(h)?d.push({moduleClass:h}):h?t(h.moduleClass)?d.push(h):console.error(["The ",f+1-i,"-th declared module has NO moduleClass, please provide it"].join("")):console.error(["The ",f+1-i,"-th declared module can NOT be found, please require it before using it"].join(""));e.modules=d;for(var a=b._modules,d=e.modules,j,k,f=0;f<d.length;++f){i=d[f].moduleClass.prototype;j=(i.forced||[]).concat(i.required||[]);for(g=0;g<j.length;++g){k=
j[g];for(h=d.length-1;h>=0;--h)if(d[h].moduleClass.prototype.name===k)break;if(h<0)if(a[k])d.push({moduleClass:a[k]});else throw Error(["Forced/Required Dependent Module '",k,"' is NOT Found for '",i.name,"'"].join(""));}}a=e.modules;g={};for(d=0;f=a[d];++d)g[f.moduleClass.prototype.name]=f;a=[];for(d in g)a.push(g[d]);e.modules=a;e=l(e);a=e.modules;d=e.modelExtensions;h=[].push;for(f=a.length-1;f>=0;--f)(g=a[f].moduleClass.prototype.modelExtensions)&&h.apply(d,g);a=e;this.model=new c(a);this._createModules(a)},
_postCreate:function(){var a=this._deferStartup=new i;this._preloadModules();this._loadModules(a).then(o(this,this.onModulesLoaded))},onModulesLoaded:function(){},setStore:function(a){this.store=a;this.reset(this);this._postCreate();this._deferStartup.callback()},setColumns:function(a){this.structure=a;var a=this._columns=k.clone(a),b={},c,d,e;if(k.isArray(a)){d=0;for(e=a.length;d<e;++d)c=a[d],c.index=d,c.id=c.id||String(d+1),b[c.id]=c}this._columnsById=b;if(this.model)this.model._cache.onSetColumns(this._columnsById)},
row:function(a,b){var c=a;typeof c=="number"&&!b&&(c=this.model.indexToId(c));if(this.model.idToIndex(c)>=0)return this._rowObj=this._rowObj||this._mixinComponent(new f(this),"row"),p(this._rowObj,{id:c});return null},column:function(a,b){var n;var c=a,d,e={};typeof c=="number"&&!b&&(n=(c=this._columns[c])&&c.id,c=n);if(c=this._columnsById[c]){this._colObj=this._colObj||this._mixinComponent(new h(this),"column");for(d in c)this._colObj[d]===void 0&&(e[d]=c[d]);return p(this._colObj,e)}return null},
cell:function(b,c,d){if(b=b instanceof f?b:this.row(b,d))if(c=c instanceof h?c:this.column(c,d))return this._cellObj=this._cellObj||this._mixinComponent(new a(this),"cell"),p(this._cellObj,{row:b,column:c});return null},columnCount:function(){return this._columns.length},rowCount:function(a){return this.model.size(a)},columns:function(a,b){return this._arr(this._columns.length,"column",a,b)},rows:function(a,b){return this._arr(this.model.size(),"row",a,b)},_uninit:function(){var a=this._modules,b;
for(b in a){b=a[b].mod;if(b.getAPIPath){var c=b.getAPIPath();if(c){var d=void 0;for(d in c)delete this[d]}}b.destroy()}this.model&&this.model.destroy()},_arr:function(a,b,c,d){for(var e=c||0,c=d>=0?c+d:a,d=[];e<c&&e<a;++e)d.push(this[b](e));for(var f in j)t(j[f])&&(d[f]=k.partial(j[f],d));return d},_preloadModules:function(){var a,b=this._modules;for(a in b)a=b[a],a.mod.preload&&a.mod.preload(a.args)},_loadModules:function(a){var b=[],c;for(c in this._modules)b.push(this._initializeModule(a,c));return new d(b)},
_mixinComponent:function(a,b){var c,d,e=this._modules;for(c in e)c=e[c].mod,d=c[b+"Mixin"],t(d)&&(d=d.apply(c)),k.mixin(a,d||{});return a},_createModules:function(a){var n;var a=a.modules,b=this._modules={},c,d,e;for(c=0;c<a.length;++c)if(d=a[c],e=d.moduleClass.prototype.name,!b[e])e=b[e]={args:d},n=e.mod=new d.moduleClass(this,d),d=n,d.forced=d.forced||[],d.optional=d.optional||[],d.loaded=new i,e.deps=d.forced.concat(d.optional),d.getAPIPath&&g(this,d.getAPIPath())},_initializeModule:function(a,
b){var c=this._modules,e=c[b],f=e.mod,g=e.deferred,h=e.deferred=g||f.loaded;g||(new d(j.map(j.filter(e.deps,function(a){return c[a]}),o(this,this._initializeModule,a)))).then(function(){f.load?f.load(e.args,a):h.fired<0&&h.callback()});return h}})})}}});define("gridx/gridx-mini",[],1);