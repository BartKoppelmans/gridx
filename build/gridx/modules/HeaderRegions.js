//>>built
define("gridx/modules/HeaderRegions","dojo/_base/declare dojo/_base/Deferred dojo/_base/array dojo/query dojo/dom-construct dojo/dom-class dojo/dom-style dojo/keys dojo/_base/event ../core/_Module".split(" "),function(q,t,g,f,r,k,s,d,h,p){return p.register(q(p,{name:"headerRegions",forced:["header"],constructor:function(){this._regions=[]},load:function(){this.refresh();this._initFocus();this.aspect(this.grid.header,"onRender","refresh");this.aspect(this.grid,"onHeaderKeyDown","_onKey");this.loaded.callback()},
add:function(a,b,c){this._regions.push({c:a,p:b||0,n:{}});c||this.refresh()},refresh:function(){var a=this,b=a.grid,c=a._regionNodes=[],l=a._regions;l.length&&(g.forEach(a._regionCnnts||[],function(b){b.remove();a._cnnts.splice(g.indexOf(a._cnnts,b),1)}),a._regionCnnts=[],l.sort(function(a,b){return b.p-a.p}),f(".gridxCell",b.header.domNode).forEach(function(d){var m=d.getAttribute("colid"),h=b.column(m,1),n=f(".gridxSortNode",d)[0];c.push(n);n.setAttribute("tabindex",-1);a._regionCnnts.push(a.connect(n,
"onblur","_onRegionBlur"));g.forEach(l,function(b){var e=b.n[m];if(!e&&(e=b.n[m]=b.c(h)))e.setAttribute("tabindex",-1),k.add(e,"gridxHeaderRegion"),a.connect(e,"onblur","_onRegionBlur");e&&(r.place(e,d,"first"),c.push(e))})}),c[a._curRegionIdx]||(a._curRegionIdx=0))},_onRegionBlur:function(a){a=this.grid.header.domNode;f(".gridxHeaderRegionFocus",a).removeClass("gridxHeaderRegionFocus");k.remove(a,"gridxHeaderFocus")},_initFocus:function(){var a=this.grid;a.focus.registerArea({name:"header",priority:0,
focusNode:a.header.domNode,scope:this,doFocus:this._doFocus,onFocus:this._onFocus})},_doFocus:function(a){this._focusRegion(this._regionNodes[this._curRegionIdx]);return!0},_onFocus:function(a){a=a.target;var b=this.grid.header.domNode,c=0>g.indexOf(this._regionNodes,a)?f(a,b).closest(".gridxSortNode")[0]:a,c=c||f(a,b).closest(".gridxHeaderRegion")[0];this._focusRegion(c);return c},_focusRegion:function(a){if(a){var b=this.grid,c=b.header.domNode,d=f(a).closest(".gridxCell",c)[0];this._curRegionIdx=
g.indexOf(this._regionNodes,a);try{a.focus()}catch(h){}setTimeout(function(){f(".gridxHeaderRegionFocus",c).removeClass("gridxHeaderRegionFocus");k.add(d,"gridxHeaderRegionFocus");k.add(c,"gridxHeaderFocus");a.focus();b.hScroller&&b.hScroller.scrollToColumn(d.getAttribute("colid"))},0)}},_onKey:function(a){if(!a.ctrlKey&&!a.shiftKey&&!a.altKey){var b=this.grid.isLeftToRight(),c=b?d.LEFT_ARROW:d.RIGHT_ARROW;a.keyCode==(b?d.RIGHT_ARROW:d.LEFT_ARROW)?(this._moveFocus(1),h.stop(a)):a.keyCode==c&&(this._moveFocus(-1),
h.stop(a))}},_moveFocus:function(a){for(var b=this._curRegionIdx+a,c=this._regionNodes;c[b]&&"none"==s.get(c[b],"display");)b+=a;c[b]&&this._focusRegion(c[b])}}))});
//@ sourceMappingURL=HeaderRegions.js.map