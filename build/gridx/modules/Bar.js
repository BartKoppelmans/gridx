//>>built
define("gridx/modules/Bar","require dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/registry dijit/a11y dojo/dom-construct ../core/_Module".split(" "),function(p,q,e,r,v,h,n,k){return k.register(q(k,{name:"bar",constructor:function(){this.defs=[]},load:function(a,c){var b=this;b._init();b.loaded.callback();c.then(function(){b._forEachPlugin(function(a){a&&a.startup&&a.startup()});setTimeout(function(){b.grid.vLayout.reLayout()},10)})},destroy:function(){this.inherited(arguments);this._forEachPlugin(function(a){a.destroy&&
a.destroy()})},_init:function(){var a,c=this._defDict={},b=function(a){a.sort(function(a,c){return a.col-c.col})},d=function(a){e.isArray(a)&&(a.length&&!e.isArray(a[0]))&&(a=[a]);return a},f=d(this.arg("top")),d=d(this.arg("bottom"));r.forEach(this.defs,function(a){var b=c[a.bar]=c[a.bar]||[];(b[a.row]=b[a.row]||[]).push(a);b.priority="priority"in a?a.priority:b.priority||-5;b.container=a.container?a.container:b.container||"headerNode";b.barClass=a.barClass?a.barClass:b.barClass||""});for(a in c)r.forEach(c[a],
b);f&&(c.top=f.concat(c.top||[]));c.top&&(c.top.priority=-5,c.top.container="headerNode");d&&(c.bottom=(c.bottom||[]).concat(d));c.bottom&&(c.bottom.priority=5,c.bottom.container="footerNode");for(a in c)b=c[a],f=a+"Node",d=this[f]=n.create("div",{"class":"gridxBar "+b.barClass||"",innerHTML:'\x3ctable border\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\x3c/table\x3e'}),this.grid.vLayout.register(this,f,b.container,b.priority),this._initFocus(a,b.priority),this.plugins=this.plugins||{},this.plugins[a]=
this._parse(b,d.firstChild)},_parse:function(a,c){for(var b,d=[],f=n.create("tbody"),t=function(a,b,c,d){b[d]&&(a.setAttribute(c||d,b[d]),delete b[d])},m=0,w=a.length;m<w;++m){for(var u=[],h=a[m],k=n.create("tr"),s=0,p=h.length;s<p;++s){var g=this._normalizePlugin(h[s]),l=n.create("td");r.forEach(["colSpan","rowSpan","style"],e.partial(t,l,g,0));t(l,g,"class","className");b=null;try{if(g.plugin)b=v.byId(g.plugin),l.appendChild(b.domNode);else if(g.pluginClass){var q=g.pluginClass;delete g.pluginClass;
b=new q(g);l.appendChild(b.domNode)}else g.content&&(l.innerHTML=g.content)}catch(x){console.error(x)}u.push(b||l);k.appendChild(l)}d.push(u);f.appendChild(k)}c.appendChild(f);return d},_normalizePlugin:function(a){a=!a||!e.isObject(a)||e.isFunction(a)?{pluginClass:a}:a.domNode?{plugin:a}:e.mixin({},a);if(e.isString(a.pluginClass))try{a.pluginClass=p(a.pluginClass)}catch(c){console.error(c)}e.isFunction(a.pluginClass)?a.grid=this.grid:a.pluginClass=null;return a},_forEachPlugin:function(a){var c=
this.plugins,b;for(b in c){var d=c[b];if(d)for(var f=0,e=d.length;f<e;++f)for(var m=d[f],h=0,k=m.length;h<k;++h)a(m[h])}},_initFocus:function(a,c){var b=this.grid.focus,d=this[a+"Node"];b&&d&&b.registerArea({name:a+"bar",priority:c,focusNode:d,doFocus:e.hitch(this,this._doFocus,d),doBlur:e.hitch(this,this._doBlur,d)})},_doFocus:function(a,c,b){this.grid.focus.stopEvent(c);(a=h._getTabNavigable(a)[0>b?"last":"first"])&&a.focus();return!!a},_doBlur:function(a,c,b){a=h._getTabNavigable(a);return c?c.target==
(0>b?a.first:a.last):!0}}))});
//@ sourceMappingURL=Bar.js.map