//>>built
define("gridx/modules/Bar","require dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/registry dijit/a11y dojo/dom-construct ../core/_Module".split(" "),function(p,q,f,r,v,h,n,l){return l.register(q(l,{name:"bar",constructor:function(){this.defs=[]},load:function(a,c){var b=this;b._init();b.loaded.callback();c.then(function(){b._forEachPlugin(function(a){a&&a.startup&&a.startup()});setTimeout(function(){b.grid.vLayout.reLayout()},10)})},destroy:function(){this.inherited(arguments);this._forEachPlugin(function(a){a.destroy&&
a.destroy()})},_init:function(){var a,c=this._defDict={},b=function(a){a.sort(function(a,c){return a.col-c.col})},d=function(a){f.isArray(a)&&(a.length&&!f.isArray(a[0]))&&(a=[a]);return a},g=d(this.arg("top")),d=d(this.arg("bottom"));r.forEach(this.defs,function(a){var b=c[a.bar]=c[a.bar]||[];(b[a.row]=b[a.row]||[]).push(a);b.priority="priority"in a?a.priority:b.priority||-5;b.container=a.container?a.container:b.container||"headerNode";b.barClass=a.barClass?a.barClass:b.barClass||""});for(a in c)r.forEach(c[a],
b);g&&(c.top=g.concat(c.top||[]));c.top&&(c.top.priority=-5,c.top.container="headerNode");d&&(c.bottom=(c.bottom||[]).concat(d));c.bottom&&(c.bottom.priority=5,c.bottom.container="footerNode");for(a in c)b=c[a],g=a+"Node",d=this[g]=n.create("div",{"class":"gridxBar "+b.barClass||"",innerHTML:'\x3ctable border\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\x3c/table\x3e'}),this.grid.vLayout.register(this,g,b.container,b.priority),this._initFocus(a,b.priority),this.plugins=this.plugins||{},this.plugins[a]=
this._parse(b,d.firstChild)},_parse:function(a,c){for(var b,d=[],g=n.create("tbody"),t=function(a,b,c,d){b[d]&&(a.setAttribute(c||d,b[d]),delete b[d])},m=0,w=a.length;m<w;++m){for(var u=[],h=a[m],l=n.create("tr"),s=0,p=h.length;s<p;++s){var e=this._normalizePlugin(h[s]),k=n.create("td");r.forEach(["colSpan","rowSpan","style"],f.partial(t,k,e,0));t(k,e,"class","className");b=null;try{if(e.plugin)b=v.byId(e.plugin),k.appendChild(b.domNode);else if(e.pluginClass){var q=e.pluginClass;delete e.pluginClass;
b=new q(e);k.appendChild(b.domNode)}else e.content&&(k.innerHTML=e.content)}catch(x){console.error(x)}e.hookPoint&&e.hookName&&(e.hookPoint[e.hookName]=b||k);u.push(b||k);l.appendChild(k)}d.push(u);g.appendChild(l)}c.appendChild(g);return d},_normalizePlugin:function(a){a=!a||!f.isObject(a)||f.isFunction(a)?{pluginClass:a}:a.domNode?{plugin:a}:f.mixin({},a);if(f.isString(a.pluginClass))try{a.pluginClass=p(a.pluginClass)}catch(c){console.error(c)}f.isFunction(a.pluginClass)?a.grid=this.grid:a.pluginClass=
null;return a},_forEachPlugin:function(a){var c=this.plugins,b;for(b in c){var d=c[b];if(d)for(var g=0,f=d.length;g<f;++g)for(var m=d[g],h=0,l=m.length;h<l;++h)a(m[h])}},_initFocus:function(a,c){var b=this.grid.focus,d=this[a+"Node"];b&&d&&b.registerArea({name:a+"bar",priority:c,focusNode:d,doFocus:f.hitch(this,this._doFocus,d),doBlur:f.hitch(this,this._doBlur,d)})},_doFocus:function(a,c,b){this.grid.focus.stopEvent(c);(a=h._getTabNavigable(a)[0>b?"last":"first"])&&a.focus();return!!a},_doBlur:function(a,
c,b){a=h._getTabNavigable(a);if(c){var d;if(!(d=c.target==(0>b?a.first:a.last)))if(c=c.target,b=0>b?a.first:a.last,!c||!b)d=!1;else{for(;c&&c!=b;)c=c.parentNode;d=!!c}b=d}else b=!0;return b}}))});
//@ sourceMappingURL=Bar.js.map