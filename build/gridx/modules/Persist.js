//>>built
define("gridx/modules/Persist","dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/json dojo/_base/unload dojo/cookie ../core/_Module".split(" "),function(l,f,g,k,m,h,n){return l(n,{name:"persist",constructor:function(a){var b=this,c=a.destroy;b.arg("key",window.location+"/"+a.id,function(a){return a});b._persistedList={};a.destroy=function(){b.save();c.call(a)};b._restoreColumnState();m.addOnWindowUnload(function(){b.save()})},enabled:!0,options:null,key:"",put:function(a,b,c){b&&g.isObject(b)?
h(a,k.toJson(b),c):h(a,null,{expires:-1})},get:function(a){return k.fromJson(h(a))},registerAndLoad:function(a,b,c){this._persistedList[a]={saver:b,scope:c,enabled:!0};return(b=this.arg("get")(this.arg("key")))?b[a]:null},features:function(){var a=this._persistedList,b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);return b},enable:function(a){this._setEnable(a,1)},disable:function(a){this._setEnable(a,0)},isEnabled:function(a){var b=this._persistedList[a];return b?b.enabled:a?!1:this.arg("enabled")},
save:function(){var a=null,b=this.arg("put");if(this.arg("enabled")){var c,e,d=this._persistedList,a={};for(c in d)e=d[c],e.enabled&&(a[c]=e.saver.call(e.scope||g.global))}b(this.arg("key"),a,this.arg("options"))},_setEnable:function(a,b){var c=this._persistedList;b=!!b;if(c[a])c[a].enabled=b;else if(!a){for(a in c)c[a].enabled=b;this.enabled=b}},_restoreColumnState:function(){var a=this.grid,b=[],c={},e,d=this.registerAndLoad("column",this._columnStateSaver,this);if(g.isArray(d)){f.forEach(d,function(a){c[a.id]=
a});f.forEach(a._columns,function(a){var b=c[a.id];b?b.id==a.id&&(a.declaredWidth=a.width=b.width):e=!0});if(e)b=a._columns;else{f.forEach(a._columns,function(a){b[c[a.id].index]=a});for(d=b.length-1;0<=d;--d)b[d]||b.splice(d,1)}a.setColumns(b)}},_columnStateSaver:function(){return f.map(this.grid._columns,function(a){return{id:a.id,index:a.index,width:a.width}})}})});
//@ sourceMappingURL=Persist.js.map