//>>built
define("gridx/modules/Header","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/query dojo/_base/sniff dojo/keys ../core/_Module".split(" "),function(n,m,p,k,g,r,h,f,l,q){return n(q,{name:"header",constructor:function(){var a=this.domNode=k.create("div",{"class":"gridxHeaderRow",role:"presentation"});this.innerNode=k.create("div",{"class":"gridxHeaderRowInner",role:"row"});this.grid._connectEvents(a,"_onMouseEvent",this)},preload:function(a){var b=
this,c=b.grid;b.domNode.appendChild(b.innerNode);b._build();c.headerNode.appendChild(b.domNode);c.vLayout.register(b,"domNode","headerNode");b.aspect(c,"onHScroll","_onHScroll");f("ff")&&b.aspect(c,"onModulesLoaded",function(){b._onHScroll(b._scrollLeft)});c.columnResizer&&b.aspect(c.columnResizer,"onResize",function(){"none"==c.hScrollerNode.style.display&&b._onHScroll(0)});b._initFocus()},destroy:function(){this.inherited(arguments);k.destroy(this.domNode)},columnMixin:{headerNode:function(){return this.grid.header.getHeaderNode(this.id)}},
hidden:!1,getHeaderNode:function(a){return h("[colid\x3d'"+this.grid._escapeId(a)+"']",this.domNode)[0]},refresh:function(){this._build();this._onHScroll(this._scrollLeft);this.onRender()},onRender:function(){},onMoveToHeaderCell:function(){},_scrollLeft:0,_build:function(){var a=this,b=a.grid,c=b.focus,e=['\x3ctable role\x3d"presentation" border\x3d"0" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3ctr\x3e'];p.forEach(b._columns,function(d){d._domId=(b.id+"-"+d.id).replace(/\s+/,"");e.push('\x3ctd id\x3d"',
d._domId,'" role\x3d"columnheader" aria-readonly\x3d"true" tabindex\x3d"-1" colid\x3d"',d.id,'" class\x3d"gridxCell ',c&&"header"==c.currentArea()&&d.id==a._focusHeaderId?a._focusClass:"",(m.isFunction(d.headerClass)?d.headerClass(d):d.headerClass)||"",'" style\x3d"width:',d.width,";min-width:",d.width,";",b.getTextDirStyle(d.id,d.name),(m.isFunction(d.headerStyle)?d.headerStyle(d):d.headerStyle)||"",'"\x3e\x3cdiv class\x3d"gridxSortNode"\x3e',d.name||"","\x3c/div\x3e\x3c/td\x3e")});e.push("\x3c/tr\x3e\x3c/table\x3e");
a.innerNode.innerHTML=e.join("");g.toggle(a.domNode,"gridxHeaderRowHidden",a.arg("hidden"))},_onHScroll:function(a){if((f("webkit")||8>f("ie"))&&!this.grid.isLeftToRight())a=this.innerNode.scrollWidth-this.innerNode.offsetWidth-a;this.innerNode.scrollLeft=this._scrollLeft=a},_onMouseEvent:function(a,b){var c=this.grid,e="onHeaderCell"+a,d="onHeader"+a;if(c._isConnected(e)||c._isConnected(d)){this._decorateEvent(b);if(0<=b.columnIndex)c[e](b);c[d](b)}},_decorateEvent:function(a){var b=h(a.target).closest(".gridxCell",
this.domNode)[0],c=b&&this.grid._columnsById[b.getAttribute("colid")];c&&(a.headerCellNode=b,a.columnId=c.id,a.columnIndex=c.index)},_focusHeaderId:null,_focusClass:"gridxHeaderCellFocus",_initFocus:function(){var a=this,b=a.grid;b.focus&&b.focus.registerArea({name:"header",priority:0,focusNode:a.innerNode,scope:a,doFocus:a._doFocus,doBlur:a._blurNode,onBlur:a._blurNode,connects:[a.connect(b,"onHeaderCellKeyDown","_onKeyDown"),a.connect(b,"onHeaderCellMouseDown",function(b){a._focusNode(a.getHeaderNode(b.columnId))})]})},
_doFocus:function(a,b){var c=this._focusHeaderId&&this.getHeaderNode(this._focusHeaderId),c=this._focusNode(c||h(".gridxCell",this.domNode)[0]);this.grid.focus.stopEvent(c&&a);return c},_focusNode:function(a){if(a){var b=this,c=b.grid,e=b._focusHeaderId=a.getAttribute("colid");if(e)return b._blurNode(),c.body._focusCellCol=c._columnsById[e].index,g.add(a,b._focusClass),setTimeout(function(){f("webkit")&&g.add(a,b._focusClass);a.focus();8>f("ie")&&(b.innerNode.scrollLeft=b._scrollLeft);c.hScroller&&
c.hScroller.scrollToColumn(e,b.innerNode)},0),!0}return!1},_blurNode:function(){var a=h("."+this._focusClass,this.innerNode)[0];a&&g.remove(a,this._focusClass);return!0},_onKeyDown:function(a){var b=this.grid,c;c=b.isLeftToRight()?1:-1;var e=a.keyCode==l.LEFT_ARROW?-c:c;if(this._focusHeaderId&&!a.ctrlKey&&!a.altKey&&(a.keyCode==l.LEFT_ARROW||a.keyCode==l.RIGHT_ARROW))if(b.focus.stopEvent(a),c=b._columnsById[this._focusHeaderId],c=b._columns[c.index+e])this._focusNode(this.getHeaderNode(c.id)),this.onMoveToHeaderCell(c.id,
a)}})});
//@ sourceMappingURL=Header.js.map