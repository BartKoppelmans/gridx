//>>built
define("gridx/modules/IndirectSelect","dojo/_base/declare dojo/_base/array dojo/_base/event dojo/query dojo/_base/lang dojo/dom-class dojo/_base/Deferred dojo/keys ../core/_Module ./RowHeader".split(" "),function(t,m,q,k,r,g,s,u,v){return t(v,{name:"indirectSelect",required:["rowHeader","selectRow"],preload:function(){var a=this,b=a.grid,c=b.focus,d=b.select.row,e=b.rowHeader;e.cellProvider=r.hitch(a,a._createSelector);a.batchConnect([d,"onHighlightChange","_onHighlightChange"],[d,"clear","_onClear"],
[d,"onSelectionChange","_onSelectionChange"],[b,"onRowMouseOver","_onMouseOver"],[b,"onRowMouseOut","_onMouseOut"],[b,"onRowKeyDown","_onKeyDown"],[b,"onHeaderKeyDown","_onKeyDown"],b.filter&&[b.filter,"onFilter","_onSelectionChange"],c&&[c,"onFocusArea",function(b){"rowHeader"==b&&a._onMouseOver()}],c&&[c,"onBlurArea",function(b){"rowHeader"==b&&a._onMouseOut()}]);d.selectByIndex&&a.arg("all")&&(a._allSelected={},e.headerProvider=r.hitch(a,a._createSelectAllBox),e.loaded.then(function(){c&&a._initFocus();
a.connect(b,"onRowHeaderHeaderMouseDown","_onSelectAll");a.connect(b,"onRowHeaderHeaderKeyDown",function(b){b.keyCode==u.SPACE&&(q.stop(b),a._onSelectAll())})}))},all:!0,_createSelector:function(a){var b=a.node(),c=b&&g.contains(b,"gridxRowSelected");a=!this.grid.row(a.id,1).isSelectable();b=b&&g.contains(b,"gridxRowPartialSelected");return this._createCheckBox(c,b,a)},_createCheckBox:function(a,b,c){var d=this._getDijitClass(),e="";c&&(e=a?"CheckedDisabled":b?"PartialDisabld":"Disabled");return['\x3cspan role\x3d"',
this._isSingle()?"radio":"checkbox",'" class\x3d"gridxIndirectSelectionCheckBox dijitReset dijitInline ',d," ",c?d+e:"",a?d+"Checked":"",b?d+"Partial":"",'" aria-checked\x3d"',a?"true":b?"mixed":"false",'"\x3e\x3cspan class\x3d"gridxIndirectSelectionCheckBoxInner"\x3e',a?"\x26#10003;":b?"\x26#9646;":"\x26#9744;","\x3c/span\x3e\x3c/span\x3e"].join("")},_createSelectAllBox:function(){return this._createCheckBox(this._allSelected[this._getPageId()])},_getPageId:function(){return this.grid.view.rootStart+
","+this.grid.view.rootCount},_onClear:function(a){var b=this._getDijitClass()+"Checked",c=this.grid;k("."+b,c.rowHeader.bodyNode).removeClass(b);c.select.row.isSelected(a)&&k('[rowid\x3d"'+c._escapeId(a)+'"].gridxRowHeaderRow .gridxIndirectSelectionCheckBox',c.rowHeader.bodyNode).addClass(b)},_onHighlightChange:function(a,b){var c=k('[visualindex\x3d"'+a.row+'"].gridxRowHeaderRow',this.grid.rowHeader.bodyNode)[0],d=c?k(".gridxIndirectSelectionCheckBox",c)[0]:void 0;if(d){var e=this._getDijitClass(),
h="mixed"==b,f=b&&!h,c=c.getAttribute("rowid"),c=!this.grid.row(c,1).isSelectable();g.toggle(d,e+"Checked",f);g.toggle(d,e+"Partial",h);g.toggle(d,e+"CheckedDisabled",f&&c);g.toggle(d,e+"PartialDisabled",h&&c);g.toggle(d,e+"Disabled",!f&&!h&&c);d.setAttribute("aria-checked",f?"true":h?"mixed":"false");d.firstChild.innerHTML=f?"\x26#10003;":h?"\x26#9646;":"\x26#9744;"}},_onMouseOver:function(){var a=this.grid.select.row;a.holdingCtrl||(this._holdingCtrl=!1,a.holdingCtrl=!0)},_onMouseOut:function(){this.hasOwnProperty("_holdingCtrl")&&
(this.grid.select.row.holdingCtrl=!1,delete this._holdingCtrl)},_getDijitClass:function(){return this._isSingle()?"dijitRadio":"dijitCheckBox"},_isSingle:function(){var a=this.grid.select.row;return a.hasOwnProperty("multiple")&&!a.arg("multiple")},_onSelectAll:function(){var a=this.grid;a.select.row[this._allSelected[this._getPageId()]?"deselectByIndex":"selectByIndex"]([0,a.view.visualCount-1])},_onSelectionChange:function(a){var b=this,c,d=b.grid,e,h=b.grid.view,f=b.model,n=h.rootStart,l=h.rootCount,
k=m.filter(a||d.select.row.getSelected(),function(a){return!f.parentId(a)});a=d.select.row._getUnselectableRows();var p=m.filter(a,function(a){return!f.parentId(a)&&!d.select.row.isSelected(a)});l===f.size()?e=l&&l-p.length==k.length:(c=new s,f.when({start:n,count:l},function(){var a=m.filter(m.map(k,function(a){return f.idToIndex(a)}),function(a){return a>=n&&a<n+l});p=m.filter(p,function(a){a=f.idToIndex(a);return a>=n&&a<n+l});e=l-p.length==a.length;c.callback()}));s.when(c,function(){if(b.arg("all")){b._allSelected[b._getPageId()]=
e;var a=b.grid.rowHeader.headerCellNode.firstChild;g.toggle(a,b._getDijitClass()+"Checked",e);a.setAttribute("aria-checked",e?"true":"false")}})},_initFocus:function(){var a=this.grid,b=a.rowHeader,c=b.headerCellNode,d=function(b){a.focus.stopEvent(b);g.add(c,"gridxHeaderCellFocus");c.focus();return!0},e=function(){g.remove(c,"gridxHeaderCellFocus");return!0};a.focus.registerArea({name:"selectAll",priority:-0.1,focusNode:b.headerNode,doFocus:d,doBlur:e,onFocus:d,onBlur:e})},_onKeyDown:function(a){65==
a.keyCode&&(a.ctrlKey&&!a.shiftKey)&&(this._allSelected[this._getPageId()]||this._onSelectAll(),q.stop(a))}})});
//@ sourceMappingURL=IndirectSelect.js.map