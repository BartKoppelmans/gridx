//>>built
define("gridx/modules/_PagedBodyMixin","dojo/_base/declare dojo/_base/lang dojo/query dojo/_base/array dojo/dom-construct dojo/dom-geometry dojo/dom-class dojo/_base/Deferred dojo/_base/sniff dijit/a11y".split(" "),function(w,l,n,r,p,z,h,q,t,u){return w([],{preload:function(){var a=this,b=a.grid,d=b.view;d.paging=1;d.rootStart=0;a._autoPageSize="auto"==a.arg("pageSize")||"auto"==b.pageSize;a.pageSize=a.pageSize||a.model._cache.pageSize||20;d.rootCount=a.pageSize;h.remove(a.domNode,"gridxBodyRowHoverEffect");
a.connect(a.domNode,"onscroll",function(c){b.hScrollerNode.scrollLeft=a.domNode.scrollLeft});a.aspect(a.model,"onSizeChange","_onSizeChange");a.arg("createBottom")&&(a._bottomNode=p.create("div",{"class":"gridxBodyBottom"}),a.createBottom(a._bottomNode),a.connect(a._bottomNode,"onmouseover",function(){n("\x3e .gridxRowOver",a.domNode).removeClass("gridxRowOver")}));a.arg("createTop")&&(a._topNode=p.create("div",{"class":"gridxBodyTop"}),a.createTop(a._topNode),a.connect(a._topNode,"onmouseover",function(){n("\x3e .gridxRowOver",
a.domNode).removeClass("gridxRowOver")}));a._initFocus()},_onSizeChange:function(a){this.grid.view.updateRootRange(0,a<this.pageSize?a:this.pageSize)},_initFocus:function(){var a=this.grid.focus,b=function(b,e,d){return b.parentNode?(a.stopEvent(e),(b=u._getTabNavigable(b)[0>d?"last":"first"])&&b.focus(),!!b):!1},d=function(a,b,d){return a.parentNode?(a=u._getTabNavigable(a),b?b.target==(0>d?a.first:a.last):!0):!0};this.inherited(arguments);this._topNode&&a.registerArea({name:"bodyTop",priority:0.9999,
focusNode:this._topNode,scope:this,doFocus:l.partial(b,this._topNode),doBlur:l.partial(d,this._topNode)});this._bottomNode&&a.registerArea({name:"bodyBottom",priority:1.0001,focusNode:this._bottomNode,scope:this,doFocus:l.partial(b,this._bottomNode),doBlur:l.partial(d,this._bottomNode)})},load:function(a,b){var d=this,c=d.grid.view;c._err&&d._loadFail(c._err);b.then(function(){if(d._autoPageSize){var a=parseInt(1.5*(d.grid.mainNode.offsetHeight/d.arg("defaultRowHeight",24)),10);d.pageSize=a;c.updateRootRange(0,
a)}d.loaded.callback()})},refresh:function(a){var b=this,d=b.grid.loadingNode,c=new q;delete b._err;h.add(d,"gridxLoading");b.grid.view.updateVisualCount().then(function(){try{b.renderStart=0;var e=b.renderCount=b.grid.view.visualCount;if("number"==typeof a&&0<=a){var m=e-a,g=n('\x3e [visualindex\x3d"'+a+'"]',b.domNode)[0],e=[],f=[];if(g){var k=b._buildRows(a,m,e,f);k&&p.place(k,g,"before")}for(;g&&(!b._bottomNode||g!==b._bottomNode);){var x=g.nextSibling,y=parseInt(g.getAttribute("visualindex"),
10),l=g.getAttribute("rowid");p.destroy(g);if(y>=a+m)b.onUnrender(l);g=x}r.forEach(f,b.onAfterRow,b);q.when(b._buildUncachedRows(e),function(){b.onRender(a,m);h.remove(d,"gridxLoading");c.callback()})}else b.renderRows(0,e,0,1),h.remove(d,"gridxLoading"),c.callback()}catch(v){b._loadFail(v),h.remove(d,"gridxLoading"),c.errback(v)}},function(a){b._loadFail(a);h.remove(d,"gridxLoading");c.errback(a)});return c},renderRows:function(a,b,d){var c=this,e=c.grid,m=[],g=[],f=c.domNode,k=e.emptyNode;if(!c._err)if(0<
b){k.innerHTML=c.arg("loadingInfo",e.nls.loadingInfo);k.style.zIndex="";d=c._buildRows(a,b,m,g);c.renderStart=a;c.renderCount=b;f.scrollTop=0;if(t("ie"))for(;f.childNodes.length;)f.removeChild(f.firstChild);f.innerHTML=d;c._topNode&&0<e.view.rootStart&&(d?f.insertBefore(c._topNode,f.firstChild):f.appendChild(c._topNode));c._bottomNode&&e.view.rootStart+e.view.rootCount<e.model.size()&&f.appendChild(c._bottomNode);f.scrollLeft=e.hScrollerNode.scrollLeft;d?k.innerHTML="":k.style.zIndex=1;if(!c._skipUnrender)c.onUnrender();
r.forEach(g,c.onAfterRow,c);q.when(c._buildUncachedRows(m),function(){c.onRender(a,b)})}else if(!{top:1,bottom:1}[d]){f.scrollTop=0;if(t("ie"))for(;f.childNodes.length;)f.removeChild(f.firstChild);f.innerHTML="";if(!c._skipUnrender)c.onUnrender();c.model.size()?f.appendChild(c._bottomNode):(k.innerHTML=c.arg("emptyInfo",e.nls.emptyInfo),k.style.zIndex=1,c.onEmpty(),c.model.free())}},onRender:function(){var a=this.domNode;n(".gridxBodyFirstRow",a).removeClass("gridxBodyFirstRow");if(this._topNode){var b=
this._topNode.nextSibling;b&&b!=this._bottomNode&&h.add(b,"gridxBodyFirstRow")}n(".gridxBodyLastRow",a).removeClass("gridxBodyLastRow");this._bottomNode&&(a=this._bottomNode.previousSibling)&&a!=this._topNode&&h.add(a,"gridxBodyLastRow")},_load:function(a){var b=this,d=b.grid,c=b.model,e=d.view,m=b.arg("pageSize"),g=a?b._bottomNode:b._topNode,f=e.rootStart,k=e.rootCount,h=a?f:f<m?0:f-m,l=a?k+m:f+k-h,q=function(c,e){b._busy(a);b._onLoadFinish(!a,c,e,function(){b.onRender(c,e);d.indirectSelect&&d.indirectSelect._onSelectionChange()})};
b._busy(a,1);c.when({start:a?f+k:h,count:a?m:f-h},function(){var f=c.size();a&&h+l>f&&(l=f-h);e.updateRootRange(h,l).then(function(){var h=a?b.renderCount:0,k=e.visualCount-b.renderCount;b.renderStart=0;b.renderCount=e.visualCount;if(k){for(var m=[],l=0;l<k;++l){var s=e.getRowInfo({visualIndex:h+l});c.isId(s.id)||m.push({parentId:s.parentId,start:s.rowIndex,count:1})}c.when(m,function(){var c=[],l=d.bodyNode.scrollHeight;str=b._buildRows(h,k,[],c);g?p.place(str,g,a?"before":"after"):p.place(str,b.domNode,
a?"last":"first");a||(d.bodyNode.scrollTop+=d.bodyNode.scrollHeight-l);(a&&g&&g.parentNode?e.rootStart+e.rootCount>=f:0===e.rootStart)&&b.domNode.removeChild(g);r.forEach(c,b.onAfterRow,b);q(h,k)})}else a&&(g&&g.parentNode&&e.rootStart+e.rootCount>=f)&&b.domNode.removeChild(g),a||n(".gridxBodyFirstRow").removeClass("gridxBodyFirstRow"),q(h,k)})})}})});
//@ sourceMappingURL=_PagedBodyMixin.js.map