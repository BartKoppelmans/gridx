//>>built
define("gridx/modules/NavigableCell","dojo/_base/declare dojo/_base/event dojo/_base/sniff dojo/dom-class dojo/keys dijit/a11y ../core/_Module".split(" "),function(p,l,m,f,g,q,n){return n.register(p(n,{name:"navigableCell",preload:function(){this.grid.focus.registerArea({name:"navigablecell",priority:1,scope:this,doFocus:this._doFocus,doBlur:this._doBlur,onFocus:this._onFocus,onBlur:this._onBlur,connects:[this.connect(this.grid,"onCellKeyDown","_onKey")]})},_doFocus:function(a,b){if(this._navigating){var c=
this._navElems,d=function(){var a=0>b?c.highest||c.last:c.lowest||c.first;a&&a.focus()};m("webkit")?d():setTimeout(d,5);return!0}return!1},_doBlur:function(a,b){if(a){var c=this,d=c.model,h=c.grid,f=h.view,k=h.body,e=c._navElems,g=e.lowest||e.first,e=e.last||e.highest||g;if((m("ie")?a.srcElement:a.target)==(0<b?e:g))l.stop(a),d.when({id:c._focusRowId},function(){var a=f.getRowInfo({parentId:d.treePath(c._focusRowId).pop(),rowIndex:d.idToIndex(c._focusRowId)}).visualIndex;k._nextCell(a,h._columnsById[c._focusColId].index,
0<b?1:-1,function(b,a){return c._isNavigable(h._columns[a].id)}).then(function(a){c._focusColId=h._columns[a.c].id;var e=f.getRowInfo({visualIndex:a.r});c._focusRowId=d.indexToId(e.rowIndex,e.parentId);k._focusCellCol=a.c;k._focusCellRow=a.r;c._beginNavigate(c._focusRowId,c._focusColId);c._doFocus(null,b)})});return!1}this._navigating=!1;return!0},_isNavigable:function(a){return(a=this.grid._columnsById[a])&&(a.navigable||void 0===a.navigable)},_beginNavigate:function(a,b){if(this._isNavigable(b)){this._navigating=
!0;this._focusColId=b;this._focusRowId=a;var c=this._navElems=q._getTabNavigable(this.grid.body.getCellNode({rowId:a,colId:b}));return(c.highest||c.last)&&(c.lowest||c.first)}return!1},_onBlur:function(){this._navigating=!1;this.grid.edit&&this.grid.edit._applyAll()},_onFocus:function(a){for(var b=a.target,c=this.grid.domNode;b&&b!==c&&!f.contains(b,"gridxCell");)b=b.parentNode;if(b&&b!==c){var c=b,d=b.getAttribute("colid");for(this.grid.hScroller.scrollToColumn(d);b&&!f.contains(b,"gridxRow");)b=
b.parentNode;if(b)return b=b.getAttribute("rowid"),c!=a.target&&this._beginNavigate(b,d)}return!1},_onKey:function(a){var b=this.grid.focus;a.keyCode==g.F2&&!this._navigating&&"body"==b.currentArea()?this._beginNavigate(a.rowId,a.columnId)&&(l.stop(a),b.focusArea("navigablecell")):a.keyCode==g.ESCAPE&&(this._navigating&&"navigablecell"==b.currentArea())&&(this._navigating=!1,b.focusArea("body"))}}))});
//@ sourceMappingURL=NavigableCell.js.map