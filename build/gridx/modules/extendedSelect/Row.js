//>>built
define("gridx/modules/extendedSelect/Row","dojo/_base/declare dojo/_base/array dojo/_base/event dojo/query dojo/_base/lang dojo/_base/Deferred dojo/_base/sniff dojo/dom-class dojo/mouse dojo/keys ../../core/_Module ./_RowCellBase".split(" "),function(q,m,r,h,p,s,t,f,u,n,w,v){return q(v,{name:"selectRow",rowMixin:{select:function(){this.grid.select.row.selectById(this.id);return this},deselect:function(){this.grid.select.row.deselectById(this.id);return this},isSelected:function(){return!0===this.model.getMark(this.id)},
isSelectable:function(){return this.grid.select.row._isSelectable(this.id)},setSelectable:function(a){this.grid.select.row.setSelectable(this.id,a)}},treeMode:!0,setSelectable:function(a,b){var c=this.model,e=this.grid.body.getRowNode({rowId:a});c.setMarkable(a,b);this.unselectable[a]=!b;e&&(f.toggle(e,"gridxRowUnselectable",!b),this.onHighlightChange({row:parseInt(e.getAttribute("visualindex"),10)},c.getMark(a)))},getSelected:function(){return this.model.getMarkedIds()},isSelected:function(){return m.every(arguments,
function(a){return!0===this.model.getMark(a)},this)},clear:function(a){h(".gridxRowSelected",this.grid.mainNode).forEach(function(a){f.remove(a,"gridxRowSelected");a.removeAttribute("aria-selected")});h(".gridxRowPartialSelected",this.grid.mainNode).forEach(function(a){f.remove(a,"gridxRowPartialSelected")});this._clear();this.model.clearMark();a||this._onSelectionChange()},onHighlightChange:function(){},_type:"row",_isSelectable:function(a){return!this.arg("unselectable",{})[a]},_getUnselectableRows:function(){var a=
[],b=this.arg("unselectable"),c;for(c in b)b[c]&&a.push(c);return a},_init:function(){var a=this,b=a.grid,c=a.arg("unselectable",{});a.model.treeMarkMode("",a.arg("treeMode"));for(var e in c)a.model.setMarkable(e,!c[e]);a.inherited(arguments);a.model._spTypes.select=1;a.model.setMarkable(p.hitch(a,a._isSelectable));a.batchConnect(b.rowHeader&&[b.rowHeader,"onMoveToRowHeaderCell","_onMoveToRowHeaderCell"],[b,"onRowMouseDown",function(d){if(u.isLeft(d)&&(a.arg("triggerOnCell")&&!f.contains(d.target,
"gridxTreeExpandoIcon")&&!f.contains(d.target,"gridxTreeExpandoInner")||!d.columnId))a._isOnCell=d.columnId,a._isOnCell&&(b.body._focusCellCol=d.columnIndex),a._start({row:d.visualIndex},b._isCopyEvent(d),d.shiftKey),!d.shiftKey&&!a.arg("canSwept")&&a._end()}],[b.body,"onAfterRow",function(a){var b=!a.isSelectable();f.toggle(a.node(),"gridxRowUnselectable",b)}],[b,"onRowMouseOver",function(d){a._selecting&&(a.arg("triggerOnCell")&&d.columnId)&&(b.body._focusCellCol=d.columnIndex);a._highlight({row:d.visualIndex})}],
[b,4>t("ff")?"onRowKeyUp":"onRowKeyDown",function(d){if(d.keyCode==n.SPACE&&(!d.columnId||b._columnsById[d.columnId].rowSelectable||a.arg("triggerOnCell")&&(!b.focus||"body"==b.focus.currentArea())))r.stop(d),a._isOnCell=d.columnId,a._start({row:d.visualIndex},b._isCopyEvent(d),d.shiftKey),a._end()}])},_markById:function(a,b){var c=this.model;m.forEach(a,function(a){c.markById(a,b)});c.when()},_markByIndex:function(a,b){var c=this.model,e=this.grid.view,d;m.forEach(a,function(a){if(p.isArrayLike(a)){var g=
a[0];a=a[1];var f;if(0<=g&&Infinity>g){f=a>=g&&Infinity>a?a-g+1:e.visualCount-g;d=e.getRowInfo({visualIndex:g});g=d.rowIndex;for(a=0;a<f;++a)c.markByIndex(a+g,b,"",d.parentId)}}else 0<=a&&Infinity>a&&(d=e.getRowInfo({visualIndex:a}),c.markByIndex(d.rowIndex,b,"",d.parentId))});return c.when()},_onRender:function(a,b){var c,e=a+b;for(c=a;c<e;++c){var d={row:c},f=this._isSelected(d)||this._selecting&&this._toSelect&&this._inRange(c,this._startItem.row,this._currentItem.row,1);f&&this._doHighlight(d,
f)}},_onMark:function(a,b,c,e){"select"==e&&(a=h('[rowid\x3d"'+this.grid._escapeId(a)+'"]',this.grid.mainNode),a.length&&(a.forEach(function(a){var c=b&&"mixed"!=b;f.toggle(a,"gridxRowSelected",c);f.toggle(a,"gridxRowPartialSelected","mixed"==b);a.setAttribute("aria-selected",!!c)}),this.onHighlightChange({row:parseInt(a[0].getAttribute("visualindex"),10)},b)))},_onMoveToCell:function(a,b,c){if(this.arg("triggerOnCell")&&c.shiftKey&&(c.keyCode==n.UP_ARROW||c.keyCode==n.DOWN_ARROW))this._start({row:a},
this.grid._isCopyEvent(c),1),this._end()},_onMoveToRowHeaderCell:function(a,b){b.shiftKey&&(this._start({row:a},this.grid._isCopyEvent(b),1),this._end())},_isSelected:function(a){a=this._getRowId(a.row);return this._isRange?0<=m.indexOf(this._refSelectedIds,a):this.model.getMark(a)},_beginAutoScroll:function(){var a=this.grid.autoScroll;this._autoScrollH=a.horizontal;a.horizontal=!1},_endAutoScroll:function(){this.grid.autoScroll.horizontal=this._autoScrollH},_doHighlight:function(a,b){h('[visualindex\x3d"'+
a.row+'"]',this.grid.mainNode).forEach(function(a){var e=b&&"mixed"!=b;f.toggle(a,"gridxRowSelected",e);f.toggle(a,"gridxRowPartialSelected","mixed"==b);a.setAttribute("aria-selected",!!e)});this.onHighlightChange(a,b)},_end:function(){this.inherited(arguments);delete this._isOnCell},_focus:function(a){var b=this.grid,c=b.focus;c&&(b.body._focusCellRow=a.row,c.focusArea(this._isOnCell?"body":"rowHeader",!0))},_addToSelected:function(a,b,c){var e=this,d=e.grid.view,f=e.model,g=e._lastEndItem,l,k,h;
e._isRange||(e._refSelectedIds=f.getMarkedIds());if(e._isRange&&e._inRange(b.row,a.row,g.row))return l=Math.min(b.row,g.row),g=Math.max(b.row,g.row),a=d.getRowInfo({visualIndex:l}).rowIndex+1,b=d.getRowInfo({visualIndex:g}).rowIndex,h=new s,f.when({start:a,count:b-a+1},function(){for(k=a;k<=b;++k){var c=f.indexToId(k),d=0<=m.indexOf(e._refSelectedIds,c);f.markById(c,d)}}).then(function(){f.when(null,function(){h.callback()})}),h;l=Math.min(a.row,b.row);g=Math.max(a.row,b.row);for(k=l;k<=g;++k)l=d.getRowInfo({visualIndex:k}),
f.markByIndex(l.rowIndex,c,"",l.parentId);return f.when()},_highlightSingle:function(a,b){var c=this._getRowId(a.row);b=this._isSelectable(c)?b?this._toSelect:this._isSelected(a):this.model.getMark(c);this._doHighlight(a,b)}})});
//@ sourceMappingURL=Row.js.map