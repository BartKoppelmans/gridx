//>>built
define("gridx/core/Core","require dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/DeferredList ./model/Model ./Row ./Column ./Cell ./_Module".split(" "),function(q,z,m,h,A,r,B,s,t,C,D){function E(a){var b={},d,c,e;if(h.isArray(a)){c=0;for(e=a.length;c<e;++c)d=a[c],d.index=c,d.id=d.id||String(c+1),b[d.id]=d}return b}function u(a,b){if(b)for(var d in b){var c=a[d],e=b[d];c&&h.isObject(c)&&!l(c)?u(c,e):a[d]=e}}function F(a){var b=a.modules,d=b.length,c=[],e,f;for(e=0;e<d;++e){f=
b[e];if(v(f))try{f=q(f)}catch(g){console.error(g)}h.isArray(f)?c=c.concat(f):c.push(f)}b=[];d=c.length;for(e=0;e<d;++e){f=c[e];l(f)&&(f={moduleClass:f});if(f){var k=f.moduleClass;if(v(k))try{k=f.moduleClass=q(k)}catch(G){console.error(G)}if(l(k)){b.push(f);continue}}console.error("The "+(e+1-a.coreModules.length)+"-th declared module can NOT be found, please require it before using it:",f)}a.modules=b}function H(a){var b=D._modules;a=a.modules;var d,c,e,f,g,k,h;for(d=0;d<a.length;++d){f=a[d].moduleClass.prototype;
g=(f.forced||[]).concat(f.required||[]);for(c=0;c<g.length;++c){k=g[c];for(e=a.length-1;0<=e&&a[e].moduleClass.prototype.name!==k;--e);0>e&&(b[k]?a.push({moduleClass:b[k]}):(h=1,console.error("Forced/Required dependent module '"+k+"' is NOT found for '"+f.name+"' module.")))}}if(h)throw Error("Some forced/required dependent modules are NOT found.");}function I(a){for(var b=0,d,c={},e=[];d=a.modules[b];++b)c[d.moduleClass.prototype.name]=d;for(b in c)e.push(c[b]);a.modules=e}function J(a){var b=a.modules,
d,c;for(d=b.length-1;0<=d;--d)(c=b[d].moduleClass.prototype.modelExtensions)&&[].push.apply(a.modelExtensions,c)}function w(a,b,d,c,e,f){var g=c||0;c=0<=e?c+e:b;for(e=[];g<c&&g<b;++g)e.push(a[d](g,0,f));return e}function n(a,b,d){var c,e=a._modules;for(c in e)c=e[c].mod,a=c[d+"Mixin"],l(a)&&(a=a.apply(c)),h.mixin(b,a||{});return b}function x(a,b,d){var c=a._modules,e=c[d],f=e.mod,g=f.loaded;e.done||(e.done=1,(new r(m.map(m.filter(e.deps,function(a){return c[a]}),y(a,x,a,b)),0,1)).then(function(){f.load?
f.load(e.args,b):0>g.fired&&g.callback()}));return g}var p=h.delegate,l=h.isFunction,v=h.isString,y=h.hitch;return z([],{setStore:function(a){this.store!=a&&(this.store=a,this.model.setStore(a))},setColumns:function(a){this.structure=a;this._columns=m.map(a,function(a){return h.mixin({},a)});this._columnsById=E(this._columns);this.edit&&this.edit._init();if(this.model)this.model._cache.onSetColumns(this._columnsById)},row:function(a,b,d){"number"==typeof a&&!b&&(a=this.model.indexToId(a,d));return this.model.byId(a)?
(this._rowObj=this._rowObj||n(this,new s(this),"row"),p(this._rowObj,{id:a})):null},column:function(a,b){var d,c,e={};"number"==typeof a&&!b&&(a=(d=this._columns[a])&&d.id);if(d=this._columnsById[a]){this._colObj=this._colObj||n(this,new t(this),"column");for(c in d)void 0===this._colObj[c]&&(e[c]=d[c]);return p(this._colObj,e)}return null},cell:function(a,b,d,c){if(a=a instanceof s?a:this.row(a,d,c))if(b=b instanceof t?b:this.column(b,d))return this._cellObj=this._cellObj||n(this,new C(this),"cell"),
p(this._cellObj,{row:a,column:b});return null},columnCount:function(){return this._columns.length},rowCount:function(a){return this.model.size(a)},columns:function(a,b){return w(this,this._columns.length,"column",a,b)},rows:function(a,b,d){return w(this,this.rowCount(d),"row",a,b,d)},onModulesLoaded:function(){},_init:function(){var a=this,b=a._deferStartup=new A;a.modules=a.modules||[];a.modelExtensions=a.modelExtensions||[];a.setColumns(a.structure);a.touch?a.touchModules&&(a.modules=a.modules.concat(a.touchModules)):
a.desktopModules&&(a.modules=a.modules.concat(a.desktopModules));F(a);H(a);I(a);J(a);a.model=new B(a);a.when=y(a.model,a.model.when);a._create();a._preload();a._load(b).then(function(){a.onModulesLoaded()})},_uninit:function(){var a=this._modules,b;for(b in a)a[b].mod.destroy();this.model&&this.model.destroy()},_create:function(){for(var a=0,b,d=this._modules={};b=this.modules[a];++a){var c;c=b.moduleClass;var e=c.prototype.name;if(!d[e]){var f=d,g=b,h=c=new c(this,b);b=b.moduleClass.prototype;b=
(b.forced||[]).concat(b.optional||[]);f[e]={args:g,mod:h,deps:b};c.getAPIPath&&u(this,c.getAPIPath())}}},_preload:function(){var a,b=this._modules;for(a in b)a=b[a],a.mod.preload&&a.mod.preload(a.args)},_load:function(a){var b=[],d;for(d in this._modules)b.push(x(this,a,d));return new r(b,0,1)}})});
//@ sourceMappingURL=Core.js.map